column_spec(6, color = spec_color(ttab$"MediumHighCa", end=0.5)) %>%
column_spec(7, color = spec_color(ttab$"MediumHighCa+VitD", end=0.5)) %>%
column_spec(8, color = spec_color(ttab$"HighCa", end=0.5)) %>%
column_spec(9, color = spec_color(ttab$"HighCa+VitD", end=0.5))
kbl(ttab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(ttab$"LowCa", end = 0.1)) %>%
column_spec(3, color = spec_color(ttab$"LowCa+VitD", end=0.2)) %>%
column_spec(4, color = spec_color(ttab$"MediumLowCa", end=0.3)) %>%
column_spec(5, color = spec_color(ttab$"MediumLowCa+VitD", end=1)) %>%
column_spec(6, color = spec_color(ttab$"MediumHighCa", end=1)) %>%
column_spec(7, color = spec_color(ttab$"MediumHighCa+VitD", end=0.5)) %>%
column_spec(8, color = spec_color(ttab$"HighCa", end=0.5)) %>%
column_spec(9, color = spec_color(ttab$"HighCa+VitD", end=0.5))
kbl(ttab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(ttab$"LowCa", end = 0.1)) %>%
column_spec(3, color = spec_color(ttab$"LowCa+VitD", end=0.2)) %>%
column_spec(4, color = spec_color(ttab$"MediumLowCa", end=0.3)) %>%
column_spec(5, color = spec_color(ttab$"MediumLowCa+VitD", end=1, option="plasma")) %>%
column_spec(6, color = spec_color(ttab$"MediumHighCa", end=1)) %>%
column_spec(7, color = spec_color(ttab$"MediumHighCa+VitD", end=0.5)) %>%
column_spec(8, color = spec_color(ttab$"HighCa", end=0.5)) %>%
column_spec(9, color = spec_color(ttab$"HighCa+VitD", end=0.5))
kbl(ttab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(ttab$"LowCa", end = 0.1)) %>%
column_spec(3, color = spec_color(ttab$"LowCa+VitD", end=0.2)) %>%
column_spec(4, color = spec_color(ttab$"MediumLowCa", end=0.3)) %>%
column_spec(5, color = spec_color(ttab$"MediumLowCa+VitD", end=1, option="plasma")) %>%
column_spec(6, color = spec_color(ttab$"MediumHighCa", end=1option="plasma", )) %>%
kbl(ttab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(ttab$"LowCa", end = 0.1)) %>%
column_spec(3, color = spec_color(ttab$"LowCa+VitD", end=0.2)) %>%
column_spec(4, color = spec_color(ttab$"MediumLowCa", end=0.3)) %>%
column_spec(5, color = spec_color(ttab$"MediumLowCa+VitD", end=1, option="plasma")) %>%
column_spec(6, color = spec_color(ttab$"MediumHighCa", end=1, option="plasma", )) %>%
column_spec(7, color = spec_color(ttab$"MediumHighCa+VitD", end=0.5)) %>%
column_spec(8, color = spec_color(ttab$"HighCa", end=0.5)) %>%
column_spec(9, color = spec_color(ttab$"HighCa+VitD", end=0.5))
kbl(ttab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(ttab$"LowCa", end = 0.1)) %>%
column_spec(3, color = spec_color(ttab$"LowCa+VitD", end=0.2)) %>%
column_spec(4, color = spec_color(ttab$"MediumLowCa", end=0.3)) %>%
column_spec(5, color = spec_color(ttab$"MediumLowCa+VitD", end=1, option="plasma")) %>%
column_spec(6, color = spec_color(ttab$"MediumHighCa", end=1, option="plasma")) %>%
column_spec(7, color = spec_color(ttab$"MediumHighCa+VitD", end=0.5)) %>%
column_spec(8, color = spec_color(ttab$"HighCa", end=0.5)) %>%
column_spec(9, color = spec_color(ttab$"HighCa+VitD", end=0.5))
kbl(ttab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(ttab$"LowCa", end = 0.1)) %>%
column_spec(3, color = spec_color(ttab$"LowCa+VitD", end=0.2)) %>%
column_spec(4, color = spec_color(ttab$"MediumLowCa", end=0.3)) %>%
column_spec(5, color = spec_color(ttab$"MediumLowCa+VitD", end=0.5, option="plasma")) %>%
column_spec(6, color = spec_color(ttab$"MediumHighCa", end=1, option="plasma")) %>%
column_spec(7, color = spec_color(ttab$"MediumHighCa+VitD", end=0.5)) %>%
column_spec(8, color = spec_color(ttab$"HighCa", end=0.5)) %>%
column_spec(9, color = spec_color(ttab$"HighCa+VitD", end=0.5))
kbl(ttab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(ttab$"LowCa", end = 0.1)) %>%
column_spec(3, color = spec_color(ttab$"LowCa+VitD", end=0.2)) %>%
column_spec(4, color = spec_color(ttab$"MediumLowCa", end=0.3)) %>%
column_spec(5, color = spec_color(ttab$"MediumLowCa+VitD", end=0.5, option="inferno")) %>%
column_spec(6, color = spec_color(ttab$"MediumHighCa", end=1, option="plasma")) %>%
column_spec(7, color = spec_color(ttab$"MediumHighCa+VitD", end=0.5)) %>%
column_spec(8, color = spec_color(ttab$"HighCa", end=0.5)) %>%
column_spec(9, color = spec_color(ttab$"HighCa+VitD", end=0.5))
kbl(ttab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(ttab$"LowCa", end = 0.1)) %>%
column_spec(3, color = spec_color(ttab$"LowCa+VitD", end=0.2)) %>%
column_spec(4, color = spec_color(ttab$"MediumLowCa", end=0.3)) %>%
column_spec(5, color = spec_color(ttab$"MediumLowCa+VitD", end=0.5, option="cividis")) %>%
column_spec(6, color = spec_color(ttab$"MediumHighCa", end=1, option="plasma")) %>%
column_spec(7, color = spec_color(ttab$"MediumHighCa+VitD", end=0.5)) %>%
column_spec(8, color = spec_color(ttab$"HighCa", end=0.5)) %>%
column_spec(9, color = spec_color(ttab$"HighCa+VitD", end=0.5))
kbl(ttab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(ttab$"LowCa", end = 0.1)) %>%
column_spec(3, color = spec_color(ttab$"LowCa+VitD", end=0.2)) %>%
column_spec(4, color = spec_color(ttab$"MediumLowCa", end=0.3)) %>%
column_spec(5, color = spec_color(ttab$"MediumLowCa+VitD", end=0.5, option="magma")) %>%
column_spec(6, color = spec_color(ttab$"MediumHighCa", end=1, option="plasma")) %>%
column_spec(7, color = spec_color(ttab$"MediumHighCa+VitD", end=0.5)) %>%
column_spec(8, color = spec_color(ttab$"HighCa", end=0.5)) %>%
column_spec(9, color = spec_color(ttab$"HighCa+VitD", end=0.5))
kbl(ttab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(ttab$"LowCa", end = 0.5, option= "magma")) %>%
column_spec(3, color = spec_color(ttab$"LowCa+VitD", end=0.2)) %>%
column_spec(4, color = spec_color(ttab$"MediumLowCa", end=0.3)) %>%
column_spec(5, color = spec_color(ttab$"MediumLowCa+VitD", end=0.5, option="magma")) %>%
column_spec(6, color = spec_color(ttab$"MediumHighCa", end=1, option="plasma")) %>%
column_spec(7, color = spec_color(ttab$"MediumHighCa+VitD", end=0.5)) %>%
column_spec(8, color = spec_color(ttab$"HighCa", end=0.5)) %>%
column_spec(9, color = spec_color(ttab$"HighCa+VitD", end=0.5))
kbl(ttab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(ttab$"LowCa", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(3, color = spec_color(ttab$"LowCa+VitD", end=0.2)) %>%
column_spec(4, color = spec_color(ttab$"MediumLowCa", end=0.3)) %>%
column_spec(5, color = spec_color(ttab$"MediumLowCa+VitD", end=0.5, option="magma")) %>%
column_spec(6, color = spec_color(ttab$"MediumHighCa", end=1, option="plasma")) %>%
column_spec(7, color = spec_color(ttab$"MediumHighCa+VitD", end=0.5)) %>%
column_spec(8, color = spec_color(ttab$"HighCa", end=0.5)) %>%
column_spec(9, color = spec_color(ttab$"HighCa+VitD", end=0.5))
kbl(ttab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(ttab$"LowCa", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(3, color = spec_color(ttab$"LowCa+VitD",end = 0.5, direction= -1, option= "magma")) %>%
column_spec(4, color = spec_color(ttab$"MediumLowCa", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(5, color = spec_color(ttab$"MediumLowCa+VitD", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(6, color = spec_color(ttab$"MediumHighCa", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(7, color = spec_color(ttab$"MediumHighCa+VitD", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(8, color = spec_color(ttab$"HighCa", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(9, color = spec_color(ttab$"HighCa+VitD", end = 0.5, direction= -1, option= "magma"))
kbl(ttab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(ttab$"LowCa", end = 0, direction= -1, option= "magma")) %>%
column_spec(3, color = spec_color(ttab$"LowCa+VitD",end = 0.5, direction= -1, option= "magma")) %>%
column_spec(4, color = spec_color(ttab$"MediumLowCa", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(5, color = spec_color(ttab$"MediumLowCa+VitD", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(6, color = spec_color(ttab$"MediumHighCa", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(7, color = spec_color(ttab$"MediumHighCa+VitD", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(8, color = spec_color(ttab$"HighCa", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(9, color = spec_color(ttab$"HighCa+VitD", end = 0.5, direction= -1, option= "magma"))
kbl(ttab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(ttab$"LowCa", end = 1, direction= -1, option= "magma")) %>%
column_spec(3, color = spec_color(ttab$"LowCa+VitD",end = 0.5, direction= -1, option= "magma")) %>%
column_spec(4, color = spec_color(ttab$"MediumLowCa", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(5, color = spec_color(ttab$"MediumLowCa+VitD", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(6, color = spec_color(ttab$"MediumHighCa", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(7, color = spec_color(ttab$"MediumHighCa+VitD", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(8, color = spec_color(ttab$"HighCa", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(9, color = spec_color(ttab$"HighCa+VitD", end = 0.5, direction= -1, option= "magma"))
kbl(ttab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(ttab$"LowCa", end = 0.9, direction= -1, option= "magma")) %>%
column_spec(3, color = spec_color(ttab$"LowCa+VitD",end = 0.5, direction= -1, option= "magma")) %>%
column_spec(4, color = spec_color(ttab$"MediumLowCa", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(5, color = spec_color(ttab$"MediumLowCa+VitD", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(6, color = spec_color(ttab$"MediumHighCa", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(7, color = spec_color(ttab$"MediumHighCa+VitD", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(8, color = spec_color(ttab$"HighCa", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(9, color = spec_color(ttab$"HighCa+VitD", end = 0.5, direction= -1, option= "magma"))
kbl(ttab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(ttab$"LowCa", end = 0.2, direction= -1, option= "magma")) %>%
column_spec(3, color = spec_color(ttab$"LowCa+VitD",end = 0.5, direction= -1, option= "magma")) %>%
column_spec(4, color = spec_color(ttab$"MediumLowCa", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(5, color = spec_color(ttab$"MediumLowCa+VitD", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(6, color = spec_color(ttab$"MediumHighCa", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(7, color = spec_color(ttab$"MediumHighCa+VitD", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(8, color = spec_color(ttab$"HighCa", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(9, color = spec_color(ttab$"HighCa+VitD", end = 0.5, direction= -1, option= "magma"))
ttab <-as.data.frame(t(tab))
ttab <-as.data.frame(t(tab))
kbl(ttab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(ttab$"LowCa", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(3, color = spec_color(ttab$"LowCa+VitD",end = 0.5, direction= -1, option= "magma")) %>%
column_spec(4, color = spec_color(ttab$"MediumLowCa", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(5, color = spec_color(ttab$"MediumLowCa+VitD", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(6, color = spec_color(ttab$"MediumHighCa", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(7, color = spec_color(ttab$"MediumHighCa+VitD", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(8, color = spec_color(ttab$"HighCa", end = 0.5, direction= -1, option= "magma")) %>%
column_spec(9, color = spec_color(ttab$"HighCa+VitD", end = 0.5, direction= -1, option= "magma"))
knitr::opts_chunk$set(echo = TRUE)
###load libraries panels tabs####
library(phyloseq) #
library(DESeq2) #
library(kableExtra) #
library(genefilter) #
library(microbiome) #
library(ggplot2)  #
library(vegan) #
library(ggpubr) #
library(ggplot2) #
library(plyr)
library(multcompView)
#####Load libraries correlations####
library(ggplot2)
library(phyloseq)
library(stringr)
library(dplyr)
#####Load libraries LR####
library(tidyverse)
library(ape)
library(ggpubr)
####Load libraries categorical histo####
library(kableExtra)
library(plyr)
library("fantaxtic")
library(data.table)
####load libraries Ratios-histo boxplots####
library(multcompView)
library(reshape)
### OTRICAS
library(plotly)
library(plyr)
library(flexdashboard)
library(shiny)
library(DT)
library(stringr)
## FUNCTIONS
source("/Volumes/GoogleDrive/Mi unidad/SIWAproject/Methods-review/functions.R")
###load libraries panels tabs####
library(phyloseq) #
library(DESeq2) #
library(kableExtra) #
library(genefilter) #
library(microbiome) #
library(ggplot2)  #
library(vegan) #
library(ggpubr) #
library(ggplot2) #
library(plyr)
library(multcompView)
#####Load libraries correlations####
library(ggplot2)
library(phyloseq)
library(stringr)
library(dplyr)
#####Load libraries LR####
library(tidyverse)
library(ape)
library(ggpubr)
####Load libraries categorical histo####
library(kableExtra)
library(plyr)
library("fantaxtic")
library(data.table)
####load libraries Ratios-histo boxplots####
library(multcompView)
library(reshape)
### OTRICAS
library(plotly)
library(plyr)
library(flexdashboard)
library(shiny)
library(DT)
library(stringr)
## FUNCTIONS
source("/Volumes/GoogleDrive/Mi unidad/SIWAproject/Methods-review/functions.R")
#open phyloseq object
#folder <- "/Users/mcadavid/Documents/Reports_review/E335_Maria/"
#ODLEPobj <- readRDS(paste0(folder, "phyloseqObject_April11.rds"))
#open data-table
## Data creada con create_full_file_for_correlations_to_analytics - Jupyter Notebook
#complete_sample_table <-read.table(paste0(folder, "performance_histo_ge_ratios_alphadiv_for_correlations.csv"),check.names = FALSE, header=T, sep="\t")
#EAFIT surveillance tables (same for all reports)
#species_taxonomy_info <-read.csv(paste0(folder, "species_metabolic_effects.csv"),check.names = FALSE, sep=";")
#genera_taxonomy_info <- read.csv(paste0(folder, "genus_metabolic_effects.csv"), check.names = FALSE, sep=";")
#broad_taxonomy_info <- read.csv(paste0(folder, "broad_groups_metabolic_effects.csv"), check.names = FALSE, sep=";")
#open phyloseq object
ODLEPobj <- readRDS("/Users/mcadavid/Documents/Reports_review/E335_Maria/phyloseqObject_April11.rds")
#open data-table
## Data creada con create_full_file_for_correlations_to_analytics - Jupyter Notebook
complete_sample_table <-read.table("/Users/mcadavid/Documents/Reports_review/E335_Maria/Subset_exp1/Correlations/performance_histo_ge_ratios_alphadiv_for_correlations.csv",check.names = FALSE, header=T, sep="\t")
#EAFIT surveillance tables (same for all reports)
species_taxonomy_info <-read.csv(file="/Users/mcadavid/Documents/Reports_review/Metabolic_effects_table_V2/species_metabolic_effects.csv",check.names = FALSE, sep=";")
genera_taxonomy_info <- read.csv(file="/Users/mcadavid/Documents/Reports_review/Metabolic_effects_table_V2/genus_metabolic_effects.csv", check.names = FALSE, sep=";")
broad_taxonomy_info <- read.csv(file="/Users/mcadavid/Documents/Reports_review/Metabolic_effects_table_V2/broad_groups_metabolic_effects.csv", check.names = FALSE, sep=";")
#Deseq outputs
dfs_filtered <- readRDS(file="/Volumes/GoogleDrive/Mi unidad/SIWAproject/Reports/Version1.0/Input_data/dfs_filtered.RData")
knitr::opts_chunk$set(echo = TRUE)
source("/Users/mcadavid/Documents/Reports_review/functions.R")
source("/Volumes/GoogleDrive/Mi unidad/SIWAproject/Methods-review/functions.R")
library(phyloseq)
library(vegan)
library(ggpubr)
library(microbiome)
library(genefilter)
library(plyr)
library(dplyr)
library(kableExtra)
library(ggplot2)
library(forcats)
library(multcompView) #letters for graph
#Open saved object
ODLEPobj <- readRDS("/Users/mcadavid/Documents/Reports_review/E321_Maria/Microbiome_data/organized_R_data/phyloseqObject.rds")
#Filter phyloseq object to keeo only samples for age 21 in this case
ODLEPobj<-subset_samples(ODLEPobj, Age=="21")
#Explore Phylosec object
rank_names(ODLEPobj)
sample_variables(ODLEPobj)
otu_table=otu_table(ODLEPobj)
colnames(tax_table(ODLEPobj))
ntaxa(ODLEPobj)
metadata= meta(ODLEPobj)
colnames(metadata)
#Filter phyloseq object by location
ODLEPobj_cecum<-subset_samples(ODLEPobj, SampleLocation=="C")
ODLEPobj_ileum<-subset_samples(ODLEPobj, SampleLocation=="I")
ODLEPobj_feces<-subset_samples(ODLEPobj, SampleLocation=="F")
##Alpha diversity in 321 and 326 according to coccidia challenge
#Open saved object
ODLEPobj <- readRDS("/Users/mcadavid/Documents/Reports_review/E321_Maria/Microbiome_data/organized_R_data/phyloseqObject.rds")
#Filter phyloseq object to keeo only samples for age 21 in this case
ODLEPobj<-subset_samples(ODLEPobj, Age=="21")
##Keep only treatments that i want
metadata <- meta(ODLEPobj)
View(metadata)
ODLEPobj <- subset_samples(ODLEPobj, TreatmentNumber%in%c("4","10"))
#Filter phyloseq object by location
ODLEPobj_cecum<-subset_samples(ODLEPobj, SampleLocation=="C")
ODLEPobj_ileum<-subset_samples(ODLEPobj, SampleLocation=="I")
#Cecum
pc <-plot_anova_diversity_edit(ODLEPobj_cecum, method = c("richness", "shannon"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Cecum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
#ileum
pi <- plot_anova_diversity_edit(ODLEPobj_ileum, method = c("richness", "shannon"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Ileum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
pc
pi
pc +   scale_color_manual(values = c("Control" = "#00263A", "Product" = "#d6cb58"))
pc
pc + scale_color_manual(values = c("Chlldd+Untrtd" = "#00263A", "Product" = "#d6cb58"))
pi
pc
pc + scale_color_manual(values = c("Chlldd+Untrtd" = "#00263A", "Product" = "#d6cb58"))
pc + scale_color_manual(values = c("Chllgd+Untrtd" = "#00263A", "Product" = "#d6cb58"))
pc + scale_color_manual(values = c("Chllgd+Untrtd" = "#00263A", "Unchllgd+Untrt" = "#d6cb58"))
#Cecum
pc <-plot_anova_diversity_edit(ODLEPobj_cecum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Cecum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12)) +
#ileum
pi <- plot_anova_diversity_edit(ODLEPobj_ileum, method = c("richness", "shannon"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Ileum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
#Cecum
pc <-plot_anova_diversity_edit(ODLEPobj_cecum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Cecum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12)) +
#ileum
pi <- plot_anova_diversity_edit(ODLEPobj_ileum, method = c("richness", "shannon"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Ileum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
#Cecum
pc <-plot_anova_diversity_edit(ODLEPobj_cecum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Cecum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12)) +
#ileum
pi <- plot_anova_diversity_edit(ODLEPobj_ileum, method = c("richness", "shannon"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Ileum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
#Cecum
pc <-plot_anova_diversity_edit(ODLEPobj_cecum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Cecum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
#ileum
pi <- plot_anova_diversity_edit(ODLEPobj_ileum, method = c("richness", "shannon"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Ileum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
pc + scale_color_manual(values = c("Chllgd+Untrtd" = "#00263A", "Unchllgd+Untrt" = "#d6cb58"))
#ileum
pi <- plot_anova_diversity_edit(ODLEPobj_ileum, method = c("richness", "shannon"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Ileum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
pi + scale_color_manual(values = c("Chllgd+Untrtd" = "#00263A", "Unchllgd+Untrt" = "#d6cb58"))
#Cecum
pc <-plot_anova_diversity_edit(ODLEPobj_cecum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Cecum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
#ileum
pi <- plot_anova_diversity_edit(ODLEPobj_ileum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Ileum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
pc + scale_color_manual(values = c("Chllgd+Untrtd" = "#00263A", "Unchllgd+Untrt" = "#d6cb58"))
pi + scale_color_manual(values = c("Chllgd+Untrtd" = "#00263A", "Unchllgd+Untrt" = "#d6cb58"))
pc + scale_color_manual(values = c("Chllgd+Untrtd" = "#00263A", "Unchllgd+Untrt" = "#d6cb58"))
pi + scale_color_manual(values = c("Chllgd+Untrtd" = "#00263A", "Unchllgd+Untrt" = "#d6cb58"))
##EXPERIMENT 326
ODLEPobj <- readRDS("/Users/mcadavid/Documents/Reports_review/E326_Maria/E326phyloseqObject.rds")
metadata <- meta(ODLEPobj)
View(metadata)
##EXPERIMENT 326
ODLEPobj <- readRDS("/Users/mcadavid/Documents/Reports_review/E326_Maria/E326phyloseqObject.rds")
metadata <- meta(ODLEPobj)
##EXPERIMENT 326
ODLEPobj <- readRDS("/Users/mcadavid/Documents/Reports_review/E326_Maria/E326phyloseqObject.rds")
metadata <- meta(ODLEPobj)
View(metadata)
ODLEPobj <- subset_samples(ODLEPobj, TreatmentNumber%in%c("4","10"))
metadata <- meta(ODLEPobj)
View(metadata)
View(metadata)
##EXPERIMENT 326
ODLEPobj <- readRDS("/Users/mcadavid/Documents/Reports_review/E326_Maria/E326phyloseqObject.rds")
metadata <- meta(ODLEPobj)
View(metadata)
ODLEPobj <- subset_samples(ODLEPobj, TreatmentNumber%in%c("1","2"))
metadata <- meta(ODLEPobj)
View(metadata)
#Filter phyloseq object by location
ODLEPobj_cecum<-subset_samples(ODLEPobj, SampleLocation=="C")
ODLEPobj_ileum<-subset_samples(ODLEPobj, SampleLocation=="I")
#Cecum
pc <-plot_anova_diversity_edit(ODLEPobj_cecum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Cecum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
#Functions
source("/Volumes/GoogleDrive/Mi unidad/SIWAproject/Methods-review/functions_ME.R")
#Functions
source("/Volumes/GoogleDrive/Mi unidad/SIWAproject/Methods-review/functions.R")
#Cecum
pc <-plot_anova_diversity_edit(ODLEPobj_cecum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Cecum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
#ileum
pi <- plot_anova_diversity_edit(ODLEPobj_ileum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Ileum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
pc + scale_color_manual(values = c("Chllgd+Untrtd" = "#00263A", "Unchllgd+Untrt" = "#d6cb58"))
pi + scale_color_manual(values = c("Chllgd+Untrtd" = "#00263A", "Unchllgd+Untrt" = "#d6cb58"))
#Cecum
pc <-plot_anova_diversity_edit(ODLEPobj_cecum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Cecum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
pc + scale_color_manual(values = c("Chllgd+Untrtd" = "#00263A", "Unchllgd+Untrt" = "#d6cb58"))
#Cecum
pc <-plot_anova_diversity_edit(ODLEPobj_cecum, method = c("richness"),
grouping_column ="Treatment")+ xlab(NULL)+ylab("Cecum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
pc + scale_color_manual(values = c("Chllgd+Untrtd" = "#00263A", "Unchllgd+Untrt" = "#d6cb58"))
#Cecum
pc <-plot_anova_diversity_edit(ODLEPobj_cecum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Cecum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
#ileum
pi <- plot_anova_diversity_edit(ODLEPobj_ileum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Ileum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
pc + scale_color_manual(values = c("Chllgd+Untrtd" = "#84a7b9ff", "Unchllgd+Untrt" = "#f2eca5ff"))
pi + scale_color_manual(values = c("Chllgd+Untrtd" = "#84a7b9ff", "Unchllgd+Untrt" = "#f2eca5ff"))
pc + scale_color_manual(values = c("Chllgd+Untrtd" = "#84a7b9ff", "Unchllgd+Untrt" = "#a99b00ff"))
pi + scale_color_manual(values = c("Chllgd+Untrtd" = "#84a7b9ff", "Unchllgd+Untrt" = "#a99b00ff"))
##EXPERIMENT 321
#Open saved object
ODLEPobj <- readRDS("/Users/mcadavid/Documents/Reports_review/E321_Maria/Microbiome_data/organized_R_data/phyloseqObject.rds")
#Filter phyloseq object to keeo only samples for age 21 in this case
ODLEPobj<-subset_samples(ODLEPobj, Age=="21")
##Keep only treatments that i want
metadata <- meta(ODLEPobj)
ODLEPobj <- subset_samples(ODLEPobj, TreatmentNumber%in%c("4","10"))
#Filter phyloseq object by location
ODLEPobj_cecum<-subset_samples(ODLEPobj, SampleLocation=="C")
ODLEPobj_ileum<-subset_samples(ODLEPobj, SampleLocation=="I")
#Cecum
pc <-plot_anova_diversity_edit(ODLEPobj_cecum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Cecum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
#ileum
pi <- plot_anova_diversity_edit(ODLEPobj_ileum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Ileum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
pc + scale_color_manual(values = c("Chllgd+Untrtd" = "#00263A", "Unchllgd+Untrt" = "#d6cb58"))
#ileum
pi <- plot_anova_diversity_edit(ODLEPobj_ileum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Ileum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
pi + scale_color_manual(values = c("Chllgd+Untrtd" = "#00263A", "Unchllgd+Untrt" = "#d6cb58"))
##EXPERIMENT 326
ODLEPobj <- readRDS("/Users/mcadavid/Documents/Reports_review/E326_Maria/E326phyloseqObject.rds")
ODLEPobj <- subset_samples(ODLEPobj, TreatmentNumber%in%c("1","2"))
metadata <- meta(ODLEPobj)
#Filter phyloseq object by location
ODLEPobj_cecum<-subset_samples(ODLEPobj, SampleLocation=="C")
ODLEPobj_ileum<-subset_samples(ODLEPobj, SampleLocation=="I")
#Cecum
pc <-plot_anova_diversity_edit(ODLEPobj_cecum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Cecum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
#ileum
pi <- plot_anova_diversity_edit(ODLEPobj_ileum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Ileum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
pc + scale_color_manual(values = c("Chllgd+Untrtd" = "#84a7b9ff", "Unchllgd+Untrt" = "#a99b00ff"))
pi + scale_color_manual(values = c("Chllgd+Untrtd" = "#84a7b9ff", "Unchllgd+Untrt" = "#a99b00ff"))
