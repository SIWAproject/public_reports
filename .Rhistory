position = position_dodge(width = 1),vjust = -0.5, size = 4)+
coord_cartesian(ylim =  c(-5, 7)) +
geom_text(data = IL1B_ile, aes(x = Treatment, y = 7, label = IL1B_ile), size = 5)
plot1
View(location)
View(IL1B_ile)
plot1 <- ggplot(il, aes(x = Treatment, y = RQ_IL1B_log, fill = Treatment)) +
geom_violin() + #geom_boxplot()+  #or geom_violin()
xlab("") +
ylab("Log-fold-change") +  geom_hline(yintercept=0, linetype="dashed") +
theme(legend.position = "none") +
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
stat_summary(fun=mean, geom="point", size=2, color="red", fill="red")+
geom_text(data = meansile, aes(label = round(RQ_IL1B_log,2), y = RQ_IL1B_log + 0.2),
position = position_dodge(width = 1),vjust = -0.5, size = 4)+
coord_cartesian(ylim =  c(-5, 7)) +
geom_text(data = IL1B_ile, aes(x = Treatment, y = 7, label = IL1B_ile), size = 5)
plot1 <- ggplot(il, aes(x = Treatment, y = RQ_IL1B_log, fill = Treatment)) +
geom_violin() + #geom_boxplot()+  #or geom_violin()
xlab("") +
ylab("Log-fold-change") +  geom_hline(yintercept=0, linetype="dashed") +
theme(legend.position = "none") +
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
stat_summary(fun=mean, geom="point", size=2, color="red", fill="red")+
geom_text(data = meansile, aes(label = round(RQ_IL1B_log,2), y = RQ_IL1B_log + 0.2),
position = position_dodge(width = 1),vjust = -0.5, size = 4)+
coord_cartesian(ylim =  c(-5, 7)) +
geom_text(data = IL1B_ile, aes(x = Treatment, y = 7, label = IL1B_ile), size = 5)
plot1
genera_taxonomy_info$Species <- "All species"
df=  rbind(species_taxonomy_info,genera_taxonomy_info)
df=df[c("Genus","Species","Key_Findings", "Probiotic_potential", "Takeaways")]
colnames(df)[3] <- "Key_Findings"
colnames(df)[4] <- "Probiotic_Potential"
colnames(df)[5] <- "Proven_Traits"
brks <- quantile(df$Probiotic_Potential, probs = seq(.05, .95, .05), na.rm = TRUE)
#clrs <- round(seq(255, 40, length.out = length(brks) + 1), 0) %>% {paste0("rgb(255,", ., ",", ., ")")}
ramp <- colorRampPalette(c("#cb766e", "#a3d291"))
clrs <- ramp(length(brks)+1)
DT::datatable(df %>% select(-Key_Findings),
rownames = FALSE, options = list(pageLength = 10)
) %>% formatStyle(
'Probiotic_Potential',
backgroundColor = styleInterval(brks, clrs)
)
df_2=broad_taxonomy_info[c("Group_Name","Finner_Classification", "Key_Findings")]
colnames(df_2)[2] <- "Taxonomic_level"
colnames(df_2)[3] <- "Key_Findings"
DT::datatable(df_2,   height = 1000000,
rownames = FALSE, options = list(pageLength = 10)
)
df_2=broad_taxonomy_info[c("Group_Name","Finner_Classification", "Key_Findings")]
colnames(df_2)[2] <- "Taxonomic_level"
colnames(df_2)[3] <- "Key_Findings"
DT::datatable(df_2,   height = 10,
rownames = FALSE, options = list(pageLength = 10)
)
df_2=broad_taxonomy_info[c("Group_Name","Finner_Classification", "Key_Findings")]
colnames(df_2)[2] <- "Taxonomic_level"
colnames(df_2)[3] <- "Key_Findings"
DT::datatable(df_2,   height = 10000,
rownames = FALSE, options = list(pageLength = 10)
)
df_2
genera_taxonomy_info
#DT::datatable(df_2,   height = 10000,
#  rownames = FALSE, options = list(pageLength = 10))
genera_taxonomy_info
colnames(df_2)[3] <- "Key_Findings"
df_2=broad_taxonomy_info[c("Group_Name","Finner_Classification", "Key_Findings")]
colnames(df_2)[2] <- "Taxonomic_level"
colnames(df_2)[3] <- "Key_Findings"
DT::datatable(df_2,   height = 10000,
rownames = FALSE, options = list(pageLength = 10)
)
knitr::opts_chunk$set(echo = TRUE)
knitr::include_graphics("diagram_E335.png")
knitr::opts_chunk$set(echo = TRUE)
###load libraries panels tabs####
library(phyloseq) #
library(DESeq2) #
library(kableExtra) #
library(genefilter) #
library(microbiome) #
library(ggplot2)  #
library(vegan) #
library(ggpubr) #
library(ggplot2) #
library(plyr)
library(multcompView)
#####Load libraries correlations####
library(ggplot2)
library(phyloseq)
library(stringr)
library(dplyr)
#####Load libraries LR####
library(tidyverse)
library(ape)
library(ggpubr)
####Load libraries categorical histo####
library(kableExtra)
library(plyr)
library("fantaxtic")
library(data.table)
####load libraries Ratios-histo boxplots####
library(multcompView)
library(reshape)
### OTRICAS
library(plotly)
library(plyr)
library(flexdashboard)
library(shiny)
library(DT)
library(stringr)
## FUNCTIONS
source("/Volumes/GoogleDrive/Mi unidad/SIWAproject/Methods-review/functions.R")
#open phyloseq object
#folder <- "/Users/mcadavid/Documents/Reports_review/E335_Maria/"
#ODLEPobj <- readRDS(paste0(folder, "phyloseqObject_April11.rds"))
#open data-table
## Data creada con create_full_file_for_correlations_to_analytics - Jupyter Notebook
#complete_sample_table <-read.table(paste0(folder, "performance_histo_ge_ratios_alphadiv_for_correlations.csv"),check.names = FALSE, header=T, sep="\t")
#EAFIT surveillance tables (same for all reports)
#species_taxonomy_info <-read.csv(paste0(folder, "species_metabolic_effects.csv"),check.names = FALSE, sep=";")
#genera_taxonomy_info <- read.csv(paste0(folder, "genus_metabolic_effects.csv"), check.names = FALSE, sep=";")
#broad_taxonomy_info <- read.csv(paste0(folder, "broad_groups_metabolic_effects.csv"), check.names = FALSE, sep=";")
#open phyloseq object
ODLEPobj <- readRDS("/Users/mcadavid/Documents/Reports_review/E335_Maria/phyloseqObject_April11.rds")
#open data-table
## Data creada con create_full_file_for_correlations_to_analytics - Jupyter Notebook
complete_sample_table <-read.table("/Users/mcadavid/Documents/Reports_review/E335_Maria/Subset_exp1/Correlations/performance_histo_ge_ratios_alphadiv_for_correlations.csv",check.names = FALSE, header=T, sep="\t")
#EAFIT surveillance tables (same for all reports)
species_taxonomy_info <-read.csv(file="/Users/mcadavid/Documents/Reports_review/Metabolic_effects_table_V2/species_metabolic_effects.csv",check.names = FALSE, sep=";")
genera_taxonomy_info <- read.csv(file="/Users/mcadavid/Documents/Reports_review/Metabolic_effects_table_V2/genus_metabolic_effects.csv", check.names = FALSE, sep=";")
broad_taxonomy_info <- read.csv(file="/Users/mcadavid/Documents/Reports_review/Metabolic_effects_table_V2/broad_groups_metabolic_effects.csv", check.names = FALSE, sep=";")
#Deseq outputs
dfs_filtered <- readRDS(file="/Volumes/GoogleDrive/Mi unidad/SIWAproject/Reports/Version1.0/Input_data/dfs_filtered.RData")
knitr::include_graphics("diagram_E335.png")
#Explore Phylosec object....
### OJO -->> REEMPLAZAR VitD NAME to send reports to externos
sample_data(ODLEPobj)$Treatment <- as.factor(stringr::str_replace(sample_data(ODLEPobj)$Treatment, "MediumAlphaD3","VitD"))
sample_data(ODLEPobj)$VitDLevel <- as.factor(sample_data(ODLEPobj)$Alphalevel)
sample_data(ODLEPobj)$VitDLevel_label <- as.factor(sample_data(ODLEPobj)$Alphad3level)
#Subset phyloseq object to include only wanted treatments
ODLEPobj <- subset_samples(ODLEPobj, TreatmentNumber%in%c("1","2","3","4","5","6","7","8"))
ODLEPobj <- subset_samples(ODLEPobj, SampleID != "0074_02C-M") #REMOVE OUTLIAR
metadata <- meta(ODLEPobj)
#Filter phyloseq object by location
ODLEPobj_cecum<-subset_samples(ODLEPobj, SampleLocation=="C")
ODLEPobj_ileum<-subset_samples(ODLEPobj, SampleLocation=="I")
ODLEPobj_feces<-subset_samples(ODLEPobj, SampleLocation=="F")
cec = table(subset(as.data.frame(as.matrix(sample_data(ODLEPobj_cecum))), select = c("Treatment")))
ile = table(subset(as.data.frame(as.matrix(sample_data(ODLEPobj_ileum))), select = c( "Treatment")))
fec = table(subset(as.data.frame(as.matrix(sample_data(ODLEPobj_feces))), select = c("Treatment")))
tab=rbind(ile,cec,fec)
tab <- as.data.frame(t(tab))
colnames(tab)=c("Ileum","Cecum","Feces")
l <- list("LowCa",
"LowCa+VitD",
"MediumLowCa",
"MediumLowCa+VitD",
"MediumHighCa",
"MediumHighCa+VitD",
"HighCa",
"HighCa+VitD")
tab <-t(tab[order(match(rownames(tab), l)),])
tab
kbl(tab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(tab$Ileum, end=0.5)) %>%
column_spec(3, color = spec_color(tab$Cecum, end=0.5)) %>%
column_spec(4, color = spec_color(tab$Feces, end=0.5))
kbl(tab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")
kbl(tab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center") %>%
column_spec(2, color = spec_color(tab$LowCa, end=0.5)) %>%
column_spec(3, color = spec_color(tab$LowCa+VitD, end=0.5)) %>%
column_spec(4, color = spec_color(tab$MediumLowCa, end=0.5)) %>%
column_spec(5, color = spec_color(tab$MediumLowCa+VitD, end=0.5)) %>%
column_spec(6, color = spec_color(tab$MediumHighCa, end=0.5)) %>%
column_spec(7, color = spec_color(tab$MediumHighCa+VitD, end=0.5)) %>%
column_spec(8, color = spec_color(tab$HighCa, end=0.5)) %>%
column_spec(9, color = spec_color(tab$HighCa+VitD, end=0.5))
tab <-t(tab[order(match(rownames(tab), l)),])
tab
tab <-t(tab[order(match(rownames(tab), l)),])
tab
kbl(tab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center") %>%
column_spec(2, color = spec_color(tab$LowCa, end=0.5)) %>%
column_spec(3, color = spec_color(tab$LowCa+VitD, end=0.5)) %>%
column_spec(4, color = spec_color(tab$MediumLowCa, end=0.5)) %>%
column_spec(5, color = spec_color(tab$MediumLowCa+VitD, end=0.5)) %>%
column_spec(6, color = spec_color(tab$MediumHighCa, end=0.5)) %>%
column_spec(7, color = spec_color(tab$MediumHighCa+VitD, end=0.5)) %>%
column_spec(8, color = spec_color(tab$HighCa, end=0.5)) %>%
column_spec(9, color = spec_color(tab$HighCa+VitD, end=0.5))
```{r Table for number of samples per treatment, echo=FALSE, fig.width = 10}
cec = table(subset(as.data.frame(as.matrix(sample_data(ODLEPobj_cecum))), select = c("Treatment")))
ile = table(subset(as.data.frame(as.matrix(sample_data(ODLEPobj_ileum))), select = c( "Treatment")))
fec = table(subset(as.data.frame(as.matrix(sample_data(ODLEPobj_feces))), select = c("Treatment")))
tab=rbind(ile,cec,fec)
tab <- as.data.frame(t(tab))
colnames(tab)=c("Ileum","Cecum","Feces")
l <- list("LowCa",
"LowCa+VitD",
"MediumLowCa",
"MediumLowCa+VitD",
"MediumHighCa",
"MediumHighCa+VitD",
"HighCa",
"HighCa+VitD")
tab <-t(tab[order(match(rownames(tab), l)),])
tab
kbl(tab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")
kbl(tab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center") %>%
column_spec(2, color = spec_color(tab$LowCa, end=0.5))
kbl(tab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center") %>%
column_spec(2, color = spec_color(tab$LowCa, end=0.5))
kbl(tab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center") %>%
column_spec(2, color = spec_color(tab$LowCa))
kbl(tab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center") %>%
column_spec(2, color = spec_color(tab$"LowCa"))
colnamnes(tab)
View(tab)
cec = table(subset(as.data.frame(as.matrix(sample_data(ODLEPobj_cecum))), select = c("Treatment")))
ile = table(subset(as.data.frame(as.matrix(sample_data(ODLEPobj_ileum))), select = c( "Treatment")))
fec = table(subset(as.data.frame(as.matrix(sample_data(ODLEPobj_feces))), select = c("Treatment")))
tab=rbind(ile,cec,fec)
tab <- as.data.frame(t(tab))
colnames(tab)=c("Ileum","Cecum","Feces")
l <- list("LowCa",
"LowCa+VitD",
"MediumLowCa",
"MediumLowCa+VitD",
"MediumHighCa",
"MediumHighCa+VitD",
"HighCa",
"HighCa+VitD")
tab <-t(tab[order(match(rownames(tab), l)),])
View(tab)
kbl(tab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(tab$Ileum, end=0.5)) %>%
column_spec(3, color = spec_color(tab$Cecum, end=0.5)) %>%
column_spec(4, color = spec_color(tab$Feces, end=0.5))
tab <-tab[order(match(rownames(tab), l)),]
kbl(tab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(tab$Ileum, end=0.5)) %>%
column_spec(3, color = spec_color(tab$Cecum, end=0.5)) %>%
column_spec(4, color = spec_color(tab$Feces, end=0.5))
cec = table(subset(as.data.frame(as.matrix(sample_data(ODLEPobj_cecum))), select = c("Treatment")))
ile = table(subset(as.data.frame(as.matrix(sample_data(ODLEPobj_ileum))), select = c( "Treatment")))
fec = table(subset(as.data.frame(as.matrix(sample_data(ODLEPobj_feces))), select = c("Treatment")))
tab=rbind(ile,cec,fec)
tab <- as.data.frame(t(tab))
colnames(tab)=c("Ileum","Cecum","Feces")
l <- list("LowCa",
"LowCa+VitD",
"MediumLowCa",
"MediumLowCa+VitD",
"MediumHighCa",
"MediumHighCa+VitD",
"HighCa",
"HighCa+VitD")
tab <- tab[order(match(rownames(tab), l)),]
kbl(tab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(tab$Ileum, end=0.5)) %>%
column_spec(3, color = spec_color(tab$Cecum, end=0.5)) %>%
column_spec(4, color = spec_color(tab$Feces, end=0.5))
View(tab)
kbl(t(tab), centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(tab$Ileum, end=0.5)) %>%
column_spec(3, color = spec_color(tab$Cecum, end=0.5)) %>%
column_spec(4, color = spec_color(tab$Feces, end=0.5))
kbl(t(tab), centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(tab$LowCa, end=0.5)) %>%
column_spec(3, color = spec_color(tab$Cecum, end=0.5)) %>%
column_spec(4, color = spec_color(tab$Feces, end=0.5))
kbl(t(tab), centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(tab$Ileum, end=0.5)) %>%
column_spec(3, color = spec_color(tab$Cecum, end=0.5)) %>%
column_spec(4, color = spec_color(tab$Feces, end=0.5))
kbl(t(tab), centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(tab$Ileum, end=0.5)) %>%
column_spec(3, color = spec_color(tab$Cecum, end=0.5)) %>%
column_spec(4, color = spec_color(tab$Feces, end=0.5)) %>%
column_spec(2, color = spec_color(tab$Ileum, end=0.5)) %>%
column_spec(3, color = spec_color(tab$Cecum, end=0.5)) %>%
column_spec(4, color = spec_color(tab$Feces, end=0.5))
kbl(t(tab), centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(tab$Ileum, end=0.5)) %>%
column_spec(3, color = spec_color(tab$Cecum, end=0.5)) %>%
column_spec(4, color = spec_color(tab$Feces, end=0.5)) %>%
column_spec(5, color = spec_color(tab$Ileum, end=0.5)) %>%
column_spec(6, color = spec_color(tab$Cecum, end=0.5)) %>%
column_spec(7, color = spec_color(tab$Feces, end=0.5))
vector=[0:6]
vector=(0:6)
kbl(t(tab), centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(vector, end=0.5)) %>%
column_spec(3, color = spec_color(tab$Cecum, end=0.5)) %>%
column_spec(4, color = spec_color(tab$Feces, end=0.5)) %>%
column_spec(5, color = spec_color(tab$Ileum, end=0.5)) %>%
column_spec(6, color = spec_color(tab$Cecum, end=0.5)) %>%
column_spec(7, color = spec_color(tab$Feces, end=0.5))
vector=(0:7)
kbl(t(tab), centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(vector, end=0.5)) %>%
column_spec(3, color = spec_color(tab$Cecum, end=0.5)) %>%
column_spec(4, color = spec_color(tab$Feces, end=0.5)) %>%
column_spec(5, color = spec_color(tab$Ileum, end=0.5)) %>%
column_spec(6, color = spec_color(tab$Cecum, end=0.5)) %>%
column_spec(7, color = spec_color(tab$Feces, end=0.5))
vector
tab <- tab[order(match(rownames(tab), l)),]
ttab <- t(tab)
View(tab)
View(ttab)
View(tab)
View(ttab)
tab <- tab[order(match(rownames(tab), l)),]
ttab <-as.data.frame(t(tab))
kbl(ttab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(ttab$LowCa, end=0.5)) %>%
column_spec(3, color = spec_color(tab$Cecum, end=0.5)) %>%
column_spec(4, color = spec_color(tab$Feces, end=0.5)) %>%
column_spec(5, color = spec_color(tab$Ileum, end=0.5)) %>%
column_spec(6, color = spec_color(tab$Cecum, end=0.5)) %>%
column_spec(7, color = spec_color(tab$Feces, end=0.5))
kbl(ttab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(ttab$LowCa, end=0.5)) %>%
column_spec(3, color = spec_color(ttab$LowCa+VitD, end=0.5)) %>%
column_spec(4, color = spec_color(ttab$MediumLowCa, end=0.5)) %>%
column_spec(5, color = spec_color(ttab$MediumLowCa+VitD, end=0.5)) %>%
column_spec(6, color = spec_color(ttab$Cecum, end=0.5)) %>%
column_spec(7, color = spec_color(ttab$Feces, end=0.5))
tab <- tab[order(match(rownames(tab), l)),]
ttab <-as.data.frame(t(tab))
kbl(ttab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(ttab$LowCa, end=0.5)) %>%
column_spec(3, color = spec_color(ttab$"LowCa+VitD", end=0.5)) %>%
column_spec(4, color = spec_color(ttab$MediumLowCa, end=0.5)) %>%
column_spec(5, color = spec_color(ttab$MediumLowCa+VitD, end=0.5)) %>%
column_spec(6, color = spec_color(ttab$Cecum, end=0.5)) %>%
column_spec(7, color = spec_color(ttab$Feces, end=0.5))
kbl(ttab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(ttab$LowCa, end=0.5)) %>%
column_spec(3, color = spec_color(ttab$"LowCa+VitD", end=0.5)) %>%
column_spec(4, color = spec_color(ttab$MediumLowCa, end=0.5)) %>%
column_spec(5, color = spec_color(ttab$"MediumLowCa+VitD", end=0.5)) %>%
column_spec(6, color = spec_color(ttab$Cecum, end=0.5)) %>%
column_spec(7, color = spec_color(ttab$Feces, end=0.5))
kbl(ttab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(ttab$LowCa, end=0.5)) %>%
column_spec(3, color = spec_color(ttab$LowCa, end=0.5)) %>%
column_spec(4, color = spec_color(ttab$LowCa, end=0.5)) %>%
column_spec(5, color = spec_color(ttab$LowCa, end=0.5)) %>%
column_spec(6, color = spec_color(ttab$LowCa, end=0.5)) %>%
column_spec(7, color = spec_color(ttab$LowCa, end=0.5)) %>%
column_spec(8, color = spec_color(ttab$LowCa, end=0.5)) %>%
column_spec(7, color = spec_color(ttab$LowCa, end=0.5))
kbl(ttab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(ttab$"LowCa", end=0.5)) %>%
column_spec(3, color = spec_color(ttab$LowCa, end=0.5)) %>%
column_spec(4, color = spec_color(ttab$LowCa, end=0.5)) %>%
column_spec(5, color = spec_color(ttab$LowCa, end=0.5)) %>%
column_spec(6, color = spec_color(ttab$LowCa, end=0.5)) %>%
column_spec(7, color = spec_color(ttab$LowCa, end=0.5)) %>%
column_spec(8, color = spec_color(ttab$LowCa, end=0.5)) %>%
column_spec(9, color = spec_color(ttab$LowCa, end=0.5))
kbl(ttab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(ttab$"LowCa", end=0.5)) %>%
column_spec(3, color = spec_color(ttab$"LowCa+VitD", end=0.5)) %>%
column_spec(4, color = spec_color(ttab$LowCa, end=0.5)) %>%
column_spec(5, color = spec_color(ttab$LowCa, end=0.5)) %>%
column_spec(6, color = spec_color(ttab$LowCa, end=0.5)) %>%
column_spec(7, color = spec_color(ttab$LowCa, end=0.5)) %>%
column_spec(8, color = spec_color(ttab$LowCa, end=0.5)) %>%
column_spec(9, color = spec_color(ttab$LowCa, end=0.5))
tab <- tab[order(match(rownames(tab), l)),]
ttab <-as.data.frame(t(tab))
kbl(ttab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(ttab$"LowCa", end=0.5)) %>%
column_spec(3, color = spec_color(ttab$"LowCa+VitD", end=0.5)) %>%
column_spec(4, color = spec_color(ttab$"MediumLowCa", end=0.5)) %>%
column_spec(5, color = spec_color(ttab$"MediumLowCa+VitD", end=0.5)) %>%
column_spec(6, color = spec_color(ttab$"MediumHighCa", end=0.5)) %>%
column_spec(7, color = spec_color(ttab$"MediumHighCa+VitD", end=0.5)) %>%
column_spec(8, color = spec_color(ttab$"HighCa", end=0.5)) %>%
column_spec(9, color = spec_color(ttab$"HighCa+VitD", end=0.5))
#open phyloseq object
#folder <- "/Users/mcadavid/Documents/Reports_review/E335_Maria/"
#ODLEPobj <- readRDS(paste0(folder, "phyloseqObject_April11.rds"))
#open data-table
## Data creada con create_full_file_for_correlations_to_analytics - Jupyter Notebook
#complete_sample_table <-read.table(paste0(folder, "performance_histo_ge_ratios_alphadiv_for_correlations.csv"),check.names = FALSE, header=T, sep="\t")
#EAFIT surveillance tables (same for all reports)
#species_taxonomy_info <-read.csv(paste0(folder, "species_metabolic_effects.csv"),check.names = FALSE, sep=";")
#genera_taxonomy_info <- read.csv(paste0(folder, "genus_metabolic_effects.csv"), check.names = FALSE, sep=";")
#broad_taxonomy_info <- read.csv(paste0(folder, "broad_groups_metabolic_effects.csv"), check.names = FALSE, sep=";")
#open phyloseq object
ODLEPobj <- readRDS("/Users/mcadavid/Documents/Reports_review/E335_Maria/phyloseqObject_April11.rds")
#open data-table
## Data creada con create_full_file_for_correlations_to_analytics - Jupyter Notebook
complete_sample_table <-read.table("/Users/mcadavid/Documents/Reports_review/E335_Maria/Subset_exp1/Correlations/performance_histo_ge_ratios_alphadiv_for_correlations.csv",check.names = FALSE, header=T, sep="\t")
#EAFIT surveillance tables (same for all reports)
species_taxonomy_info <-read.csv(file="/Users/mcadavid/Documents/Reports_review/Metabolic_effects_table_V2/species_metabolic_effects.csv",check.names = FALSE, sep=";")
genera_taxonomy_info <- read.csv(file="/Users/mcadavid/Documents/Reports_review/Metabolic_effects_table_V2/genus_metabolic_effects.csv", check.names = FALSE, sep=";")
broad_taxonomy_info <- read.csv(file="/Users/mcadavid/Documents/Reports_review/Metabolic_effects_table_V2/broad_groups_metabolic_effects.csv", check.names = FALSE, sep=";")
#Deseq outputs
dfs_filtered <- readRDS(file="/Volumes/GoogleDrive/Mi unidad/SIWAproject/Reports/Version1.0/Input_data/dfs_filtered.RData")
###load libraries panels tabs####
library(phyloseq) #
library(DESeq2) #
library(kableExtra) #
library(genefilter) #
library(microbiome) #
library(ggplot2)  #
library(vegan) #
library(ggpubr) #
library(ggplot2) #
library(plyr)
library(multcompView)
#####Load libraries correlations####
library(ggplot2)
library(phyloseq)
library(stringr)
library(dplyr)
#####Load libraries LR####
library(tidyverse)
library(ape)
library(ggpubr)
####Load libraries categorical histo####
library(kableExtra)
library(plyr)
library("fantaxtic")
library(data.table)
####load libraries Ratios-histo boxplots####
library(multcompView)
library(reshape)
### OTRICAS
library(plotly)
library(plyr)
library(flexdashboard)
library(shiny)
library(DT)
library(stringr)
## FUNCTIONS
source("/Volumes/GoogleDrive/Mi unidad/SIWAproject/Methods-review/functions.R")
#Explore Phylosec object....
### OJO -->> REEMPLAZAR VitD NAME to send reports to externos
sample_data(ODLEPobj)$Treatment <- as.factor(stringr::str_replace(sample_data(ODLEPobj)$Treatment, "MediumAlphaD3","VitD"))
sample_data(ODLEPobj)$VitDLevel <- as.factor(sample_data(ODLEPobj)$Alphalevel)
sample_data(ODLEPobj)$VitDLevel_label <- as.factor(sample_data(ODLEPobj)$Alphad3level)
#Subset phyloseq object to include only wanted treatments
ODLEPobj <- subset_samples(ODLEPobj, TreatmentNumber%in%c("1","2","3","4","5","6","7","8"))
ODLEPobj <- subset_samples(ODLEPobj, SampleID != "0074_02C-M") #REMOVE OUTLIAR
metadata <- meta(ODLEPobj)
#Filter phyloseq object by location
ODLEPobj_cecum<-subset_samples(ODLEPobj, SampleLocation=="C")
ODLEPobj_ileum<-subset_samples(ODLEPobj, SampleLocation=="I")
ODLEPobj_feces<-subset_samples(ODLEPobj, SampleLocation=="F")
cec = table(subset(as.data.frame(as.matrix(sample_data(ODLEPobj_cecum))), select = c("Treatment")))
ile = table(subset(as.data.frame(as.matrix(sample_data(ODLEPobj_ileum))), select = c( "Treatment")))
fec = table(subset(as.data.frame(as.matrix(sample_data(ODLEPobj_feces))), select = c("Treatment")))
tab=rbind(ile,cec,fec)
tab <- as.data.frame(t(tab))
colnames(tab)=c("Ileum","Cecum","Feces")
l <- list("LowCa",
"LowCa+VitD",
"MediumLowCa",
"MediumLowCa+VitD",
"MediumHighCa",
"MediumHighCa+VitD",
"HighCa",
"HighCa+VitD")
tab <- tab[order(match(rownames(tab), l)),]
ttab <-as.data.frame(t(tab))
kbl(ttab, centering = FALSE) %>%
kable_styling(full_width = F, position = "center")  %>%
column_spec(2, color = spec_color(ttab$"LowCa", end=0.5)) %>%
column_spec(3, color = spec_color(ttab$"LowCa+VitD", end=0.5)) %>%
column_spec(4, color = spec_color(ttab$"MediumLowCa", end=0.5)) %>%
column_spec(5, color = spec_color(ttab$"MediumLowCa+VitD", end=0.5)) %>%
column_spec(6, color = spec_color(ttab$"MediumHighCa", end=0.5)) %>%
column_spec(7, color = spec_color(ttab$"MediumHighCa+VitD", end=0.5)) %>%
column_spec(8, color = spec_color(ttab$"HighCa", end=0.5)) %>%
column_spec(9, color = spec_color(ttab$"HighCa+VitD", end=0.5))
