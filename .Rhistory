library(multcompView)
#####Load libraries correlations####
library(ggplot2)
library(phyloseq)
library(stringr)
library(dplyr)
#####Load libraries LR####
library(tidyverse)
library(ape)
library(ggpubr)
####Load libraries categorical histo####
library(kableExtra)
library(plyr)
library("fantaxtic")
library(data.table)
####load libraries Ratios-histo boxplots####
library(multcompView)
library(reshape)
### OTRICAS
library(plotly)
library(plyr)
library(flexdashboard)
library(shiny)
library(DT)
library(stringr)
library(rstatix)
library(microViz)
library(lsr)
## FUNCTIONS
source("/Volumes/GoogleDrive/Mi unidad/SIWAproject/Methods-review(master)/functions.R")
#open phyloseq object
folder <- "/Volumes/GoogleDrive/Mi unidad/SIWAproject/Reports/Version1.0/Input_data/"
ODLEPobj <- readRDS(paste0(folder, "phyloseqObject_April11.rds"))
#open data-table
## Data creada con create_full_file_for_correlations_to_analytics - Jupyter Notebook
complete_sample_table <-read.table(paste0(folder, "performance_histo_ge_ratios_alphadiv_for_correlations.csv"),check.names = FALSE, header=T, sep="\t")
#EAFIT surveillance tables (same for all reports)
species_taxonomy_info <-read.csv(paste0(folder, "species_metabolic_effects.csv"),check.names = FALSE, sep=";")
genera_taxonomy_info <- read.csv(paste0(folder, "genus_metabolic_effects.csv"), check.names = FALSE, sep=";")
broad_taxonomy_info <- read.csv(paste0(folder, "broad_groups_metabolic_effects.csv"), check.names = FALSE, sep=";")
#Deseq outputs
dfs_filtered <- readRDS(file="/Volumes/GoogleDrive/Mi unidad/SIWAproject/Reports/Version1.0/Input_data/dfs_filtered.RData")
list_dfs_filtered <- readRDS("/Volumes/GoogleDrive/Mi unidad/SIWAproject/Reports/Projects/E335_MS/diff_abund/list_dfs_filtered_bygenus_perf.RData")
plot_deseq_report_with_color_easyread_for_genera(list_dfs_filtered, 1,
"Cecum: Low vs. High FCR",
species_taxonomy_info,
genera_taxonomy_info,  size=8)
plot_deseq_report_with_color_easyread_for_genera(list_dfs_filtered, 2,
"Ileum: Low vs. High FCR",
species_taxonomy_info,
genera_taxonomy_info,  size=8)
knitr::opts_chunk$set(echo = TRUE)
###load libraries panels tabs####
library(phyloseq) #
library(DESeq2) #
library(kableExtra) #
library(genefilter) #
library(microbiome) #
library(ggplot2)  #
library(vegan) #
library(ggpubr) #
library(ggplot2) #
library(plyr)
library(multcompView)
#####Load libraries correlations####
library(ggplot2)
library(phyloseq)
library(stringr)
library(dplyr)
#####Load libraries LR####
library(tidyverse)
library(ape)
library(ggpubr)
####Load libraries categorical histo####
library(kableExtra)
library(plyr)
library("fantaxtic")
library(data.table)
####load libraries Ratios-histo boxplots####
library(multcompView)
library(reshape)
### OTRICAS
library(plotly)
library(plyr)
library(flexdashboard)
library(shiny)
library(DT)
library(stringr)
library(rstatix)
library(microViz)
library(lsr)
## FUNCTIONS
source("/Volumes/GoogleDrive/Mi unidad/SIWAproject/Methods-review(master)/functions.R")
#open phyloseq object
folder <- "/Volumes/GoogleDrive/Mi unidad/SIWAproject/Reports/Version1.0/Input_data/"
ODLEPobj <- readRDS(paste0(folder, "phyloseqObject_April11.rds"))
#open data-table
## Data creada con create_full_file_for_correlations_to_analytics - Jupyter Notebook
complete_sample_table <-read.table(paste0(folder, "performance_histo_ge_ratios_alphadiv_for_correlations.csv"),check.names = FALSE, header=T, sep="\t")
#EAFIT surveillance tables (same for all reports)
species_taxonomy_info <-read.csv(paste0(folder, "species_metabolic_effects.csv"),check.names = FALSE, sep=";")
genera_taxonomy_info <- read.csv(paste0(folder, "genus_metabolic_effects.csv"), check.names = FALSE, sep=";")
broad_taxonomy_info <- read.csv(paste0(folder, "broad_groups_metabolic_effects.csv"), check.names = FALSE, sep=";")
#Deseq outputs
dfs_filtered <- readRDS(file="/Volumes/GoogleDrive/Mi unidad/SIWAproject/Reports/Version1.0/Input_data/dfs_filtered.RData")
#Explore Phylosec object....
### OJO -->> REEMPLAZAR VitD NAME to send reports to externos
sample_data(ODLEPobj)$Treatment <- as.factor(stringr::str_replace(sample_data(ODLEPobj)$Treatment, "MediumAlphaD3","VitD"))
sample_data(ODLEPobj)$VitDLevel <- as.factor(sample_data(ODLEPobj)$Alphalevel)
sample_data(ODLEPobj)$VitDLevel_label <- as.factor(sample_data(ODLEPobj)$Alphad3level)
#Subset phyloseq object to include only wanted treatments
ODLEPobj <- subset_samples(ODLEPobj, TreatmentNumber%in%c("1","2","3","4","5","6","7","8"))
ODLEPobj <- subset_samples(ODLEPobj, SampleID != "0074_02C-M") #REMOVE OUTLIAR
metadata <- meta(ODLEPobj)
#Filter phyloseq object by location
ODLEPobj_cecum<-subset_samples(ODLEPobj, SampleLocation=="C")
ODLEPobj_ileum<-subset_samples(ODLEPobj, SampleLocation=="I")
ODLEPobj_feces<-subset_samples(ODLEPobj, SampleLocation=="F")
histo <- complete_sample_table
#change labels
#Add treatments and treatment numbers (1-8)
histo <- histo %>%
mutate(TreatmentNumber = if_else(KitID == 70, 1,
ifelse(KitID == 71, 2,
ifelse(KitID == 72, 3,
ifelse(KitID == 73, 4,
ifelse(KitID == 74, 5,
ifelse(KitID == 75, 6,
ifelse(KitID == 76, 7,8))))))))
histo <- histo %>%
mutate(Treatment = if_else(KitID == 70, "LowCa",
ifelse(KitID == 71, "LowCa+VitD",
ifelse(KitID == 72, "MediumLowCa",
ifelse(KitID == 73, "MediumLowCa+VitD",
ifelse(KitID == 74, "MediumHighCa",
ifelse(KitID == 75, "MediumHighCa+VitD",
ifelse(KitID == 76, "HighCa",
ifelse(KitID == 77, "HighCa+VitD","other")))))))))
histo <- histo %>%
mutate(Alphalevel = if_else(KitID == 70, "0 VitD",
ifelse(KitID == 71, "VitD",
ifelse(KitID == 72, "0 VitD",
ifelse(KitID == 73, "VitD",
ifelse(KitID == 74, "0 VitD",
ifelse(KitID == 75, "VitD",
ifelse(KitID == 76, "0 VitD","VitD"))))))))
#subset by location
histo_cecum <- histo[histo$SampleLocation == 'C',]
histo_ileum <- histo[histo$SampleLocation == 'I',]
####Anova tests
#cecum AdditiveScore
res.aov <- aov(AdditiveScore ~ Treatment, data = histo_cecum)
summary(res.aov) #Additive score changes significantly with treatment in cecum. pval=0.00232*
#plot(res.aov, 1) # test 1. Homogeneity of variances
#plot(res.aov, 2) # test 2. Normality
tukey <- TukeyHSD(res.aov)
print(tukey)
#letters to add statistics to graph
cld <- multcompLetters4(res.aov, tukey)
cld2 <- data.frame(letters = cld$'Treatment'$Letters) #table with letters per treatment
cld2$Treatment <- rownames(cld2)
names(cld2)[1] <- "histosig"
#ileum AdditiveScore
res.aov <- aov(AdditiveScore ~ Treatment, data = histo_ileum)
summary(res.aov) #Additive score does not change significantly with treatment in ileum. pval=0.205
tukey <- TukeyHSD(res.aov)
print(tukey)
#letters to add statistics to graph
cld <- multcompLetters4(res.aov, tukey)
cld3 <- data.frame(letters = cld$'Treatment'$Letters) #table with letters per treatment
cld3$Treatment <- rownames(cld3)
names(cld3)[1] <- "histosig"
#pivot table to plot
histo_cecum2 <- histo_cecum %>%
pivot_longer(cols = c("OverallArchitecture", "MucosalIntegrity", "LymphoidImmune", "InflammationSeverity", "MicrobialOrganisms"), names_to = "ScoreCategory", values_to = "Value")
histo_ileum2 <- histo_ileum %>%
pivot_longer(cols = c("OverallArchitecture", "MucosalIntegrity", "LymphoidImmune", "InflammationSeverity", "MicrobialOrganisms"), names_to = "ScoreCategory", values_to = "Value")
#Stacked bars by SAMPLE
histo_by_samples_cecum <- ggplot(histo_cecum2, aes(fill = ScoreCategory, y =Value , x = SampleID)) +
geom_bar(stat = "identity")  +
ggtitle("Histopathology scores by sample (Cecum)") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
histo_by_samples_cecum
histo_by_samples_ileum <- ggplot(histo_ileum2, aes(fill = ScoreCategory, y =Value , x = SampleID)) +
geom_bar(stat = "identity")  +
ggtitle("Histopathology scores by sample (Ileum)") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
histo_by_samples_ileum
histo_by_samples_ileum
#Satcked bars by TREATMENT
#cecum
histo_c <- split(histo_cecum2, histo_cecum2$Treatment)
dff <- lapply(histo_c, function(x) ddply(x, .(ScoreCategory),
summarize, mean=mean(Value)))
listDF <- list()
for (i in 1:length(dff)){
#print(i)
dff[[i]]$Treatment <- names(dff)[i]
listDF[[i]] <- dff[[i]]
}
dfff <- do.call(rbind, listDF)
dfff <- dfff %>%
mutate( Treatment=factor(Treatment,levels=c("LowCa", "LowCa+VitD", "MediumLowCa", "MediumLowCa+VitD", "MediumHighCa", "MediumHighCa+VitD", "HighCa","HighCa+VitD")) )
treatments_cecum <- ggplot(dfff, aes(fill = ScoreCategory, y =mean , x =Treatment)) +
ylab("Mean additive Score") + xlab("") +
geom_bar(stat = "identity")  +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
theme(text=element_text(size=15))
#Add significancy letters manually
histo_cec_plot <- treatments_cecum+ annotate("text", x = 7, y = 14, label = cld2$histosig[2]) +
annotate("text", x = 6, y = 14, label = cld2$histosig[5]) +
annotate("text", x = 3, y = 14, label = cld2$histosig[3]) +
annotate("text", x = 8, y = 14, label = cld2$histosig[1]) +
annotate("text", x = 4, y = 14, label = cld2$histosig[8]) +
annotate("text", x = 5, y = 14, label = cld2$histosig[4]) +
annotate("text", x = 2, y = 14, label = cld2$histosig[6]) +
annotate("text", x = 1, y = 14, label = cld2$histosig[7])
ggplotly(histo_cec_plot)
histo <- complete_sample_table
#subset by location
histo_cecum <- histo[histo$SampleLocation == 'C',]
histo_ileum <- histo[histo$SampleLocation == 'I',]
#ileum AdditiveScore
res.aov <- aov(InflammationSeverity ~ Treatment, data = histo_ileum)
summary(res.aov) #inflammation tends to change with treatment in ileum. pval=0.03
#Stacked bars by SAMPLE
histo_by_samples_cecum <- ggplot(histo_cecum2, aes(fill = ScoreCategory, y =Value , x = SampleID)) +
geom_bar(stat = "identity")  +
ggtitle("Histopathology scores by sample (Cecum)") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
histo_by_samples_cecum
histo_by_samples_ileum <- ggplot(histo_ileum2, aes(fill = ScoreCategory, y =Value , x = SampleID)) +
geom_bar(stat = "identity")  +
ggtitle("Histopathology scores by sample (Ileum)") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
histo_by_samples_ileum
View(histo_cecum2)
histo <- complete_sample_table
histo <- complete_sample_table
#subset by location
histo_cecum <- histo[histo$SampleLocation == 'C',]
View(histo_cecum)
#subset treatments with med-low ca
subset(histo_cecum, TreatmentNumber == '3'|TreatmentNumber == '4')
View(histo_c)
View(histo_cecum)
#subset treatments with med-low ca
histoc_ca<-subset(histo_cecum, TreatmentNumber == '3'|TreatmentNumber == '4')
View(histoc_ca)
#Stacked bars by SAMPLE
histo_by_samples_cecum <- ggplot(histoc_ca, aes(fill = ScoreCategory, y =Value , x = SampleID)) +
geom_bar(stat = "identity")  +
ggtitle("Histopathology scores by sample (Cecum)") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
histo_by_samples_cecum
#Satcked bars by TREATMENT
#cecum
histo_c <- split(histo_cecum2, histo_cecum2$Treatment)
View(histo_c)
#Satcked bars by TREATMENT
#cecum
histo_c <- split(histo_cecum2, histo_cecum2$Treatment)
dff <- lapply(histo_c, function(x) ddply(x, .(ScoreCategory),
summarize, mean=mean(Value)))
histo <- complete_sample_table
#subset by location
histo_cecum <- histo[histo$SampleLocation == 'C',]
#subset treatments with med-low ca
histoca_cecum<- histo_cecum[histo_cecum$Treatment  %in% c("MediumLowCa+VitD","MediumLowCa"),]
histoca_cecum <- histoca_cecum %>%
pivot_longer(cols = c("OverallArchitecture", "MucosalIntegrity", "LymphoidImmune", "InflammationSeverity", "MicrobialOrganisms"), names_to = "ScoreCategory", values_to = "Value")
#Stacked bars by SAMPLE
histo_by_samples_cecum <- ggplot(histoca_cecum, aes(fill = ScoreCategory, y =Value , x = SampleID)) +
geom_bar(stat = "identity")  +
ggtitle("Histopathology scores by sample (Cecum)") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
histo_by_samples_cecum
View(histoca_cecum)
histo <- complete_sample_table
View(histo)
#subset by location
histo_cecum <- histo[histo$SampleLocation == 'C',]
#subset treatments with med-low ca
histoca_cecum<- histo_cecum[histo_cecum$TreatmentNumber  %in% c("3","4"),]
histoca_cecum <- histoca_cecum %>%
pivot_longer(cols = c("OverallArchitecture", "MucosalIntegrity", "LymphoidImmune", "InflammationSeverity", "MicrobialOrganisms"), names_to = "ScoreCategory", values_to = "Value")
#Stacked bars by SAMPLE
histo_by_samples_cecum <- ggplot(histoca_cecum, aes(fill = ScoreCategory, y =Value , x = SampleID)) +
geom_bar(stat = "identity")  +
ggtitle("Histopathology scores by sample (Cecum)") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
histo_by_samples_cecum
View(histoca_cecum)
#Stacked bars by SAMPLE
histo_by_samples_cecum <- ggplot(histoca_cecum, aes(fill = ScoreCategory, y =Value , x = AnimalID)) +
geom_bar(stat = "identity")  +
ggtitle("Histopathology scores by sample (Cecum)") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
histo_by_samples_cecum
#Stacked bars by SAMPLE
histo_by_samples_cecum <- ggplot(histoca_cecum, aes(fill = ScoreCategory, y =Value , x = AnimalID)) +
geom_bar(stat = "identity", position="dodge", show.legend = FALSE)  +
ggtitle("Histopathology scores by sample (Cecum)") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
histo_by_samples_cecum
#Stacked bars by SAMPLE
histo_by_samples_cecum <- ggplot(histoca_cecum, aes(fill = ScoreCategory, y =Value , x = AnimalID)) +
geom_bar(stat = "identity")  +
ggtitle("Histopathology scores by sample (Cecum)") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
histo_by_samples_cecum
histo_by_samples_cecum <- ggplot(histoca_cecum, aes(x = VitDLevel, y =Value, fill=SampleID)) +
geom_bar(stat="identity", position="dodge", show.legend = FALSE)  +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
histo_by_samples_cecum
View(histoca_cecum)
#Stacked bars by SAMPLE
histo_by_samples_cecum <- ggplot(histoca_cecum, aes(fill = ScoreCategory, y =Value , x = AnimalID)) +
geom_bar(stat = "identity")  +
ggtitle("Histopathology scores by sample (Cecum)") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
histo_by_samples_cecum
#Satcked bars by TREATMENT
#cecum
histo_c <- split(histo_cecum2, histo_cecum2$Treatment)
#Satcked bars by TREATMENT
#cecum
histo_c <- split(histoca_cecum, histoca_cecum$Treatment)
View(histo_c)
dff <- lapply(histo_c, function(x) ddply(x, .(ScoreCategory),
summarize, mean=mean(Value)))
View(histoca_cecum)
#Satcked bars by TREATMENT
#cecum
histo_c <- split(histoca_cecum, histoca_cecum$Alphad3_level)
dff <- lapply(histo_c, function(x) ddply(x, .(ScoreCategory),
summarize, mean=mean(Value)))
listDF <- list()
for (i in 1:length(dff)){
#print(i)
dff[[i]]$Treatment <- names(dff)[i]
listDF[[i]] <- dff[[i]]
}
dfff <- do.call(rbind, listDF)
View(dfff)
dfff <- dfff %>%
mutate( Treatment=factor(Treatment,levels=c("LowCa", "LowCa+VitD", "MediumLowCa", "MediumLowCa+VitD", "MediumHighCa", "MediumHighCa+VitD", "HighCa","HighCa+VitD")) )
#Satcked bars by TREATMENT
#cecum
histo_c <- split(histoca_cecum, histoca_cecum$Alphad3_level)
dff <- lapply(histo_c, function(x) ddply(x, .(ScoreCategory),
summarize, mean=mean(Value)))
listDF <- list()
for (i in 1:length(dff)){
#print(i)
dff[[i]]$Treatment <- names(dff)[i]
listDF[[i]] <- dff[[i]]
}
dfff <- do.call(rbind, listDF)
View(dfff)
dfff <- dfff %>%
mutate( Treatment=factor(Treatment,levels=c("No-product", "AlphaD3")) )
treatments_cecum <- ggplot(dfff, aes(fill = ScoreCategory, y =mean , x =Treatment)) +
ylab("Mean additive Score") + xlab("") +
geom_bar(stat = "identity")  +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
theme(text=element_text(size=15))
View(cld2)
#Satcked bars by TREATMENT
#cecum
histo_c <- split(histoca_cecum, histoca_cecum$Alphad3_level)
dff <- lapply(histo_c, function(x) ddply(x, .(ScoreCategory),
summarize, mean=mean(Value)))
listDF <- list()
for (i in 1:length(dff)){
#print(i)
dff[[i]]$Treatment <- names(dff)[i]
listDF[[i]] <- dff[[i]]
}
dfff <- do.call(rbind, listDF)
dfff <- dfff %>%
mutate( Treatment=factor(Treatment,levels=c("No-product", "AlphaD3")) )
treatments_cecum <- ggplot(dfff, aes(fill = ScoreCategory, y =mean , x =Treatment)) +
ylab("Mean additive Score") + xlab("") +
geom_bar(stat = "identity")  +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
theme(text=element_text(size=15))
treatments_cecum
treatments_cecum <- ggplot(dfff, aes(fill = ScoreCategory, y =mean , x =Alphad3_level)) +
ylab("Mean additive Score") + xlab("") +
geom_bar(stat = "identity")  +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
theme(text=element_text(size=15))
treatments_cecum
#Satcked bars by TREATMENT
#cecum
histo_c <- split(histoca_cecum, histoca_cecum$Alphad3_level)
View(histo_c)
View(histoca_cecum)
sto_c <- split(histoca_cecum, histoca_cecum
View(histo_c)
dff <- lapply(histo_c, function(x) ddply(x, .(ScoreCategory),
summarize, mean=mean(Value)))
View(dff)
listDF <- list()
for (i in 1:length(dff)){
#print(i)
dff[[i]]$Treatment <- names(dff)[i]
listDF[[i]] <- dff[[i]]
}
dfff <- do.call(rbind, listDF)
View(dfff)
dfff <- dfff %>%
mutate( Treatment=factor(Treatment,levels=c("No-product", "AlphaD3")) )
dfff <- do.call(rbind, listDF)
treatments_cecum <- ggplot(dfff, aes(fill = ScoreCategory, y =mean , x =Treatment)) +
ylab("Mean additive Score") + xlab("") +
geom_bar(stat = "identity")  +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
theme(text=element_text(size=15))
treatments_cecum
View(histoca_cecum)
histo <- complete_sample_table
#subset by location
histo_cecum <- histo[histo$SampleLocation == 'C',]
#subset treatments with med-low ca
histoca_cecum<- histo_cecum[histo_cecum$TreatmentNumber  %in% c("3","4"),]
t.test(Value ~ Treatment, data = histo_ileum3)
histoca_cecum <- histoca_cecum %>%
pivot_longer(cols = c("OverallArchitecture", "MucosalIntegrity", "LymphoidImmune", "InflammationSeverity", "MicrobialOrganisms"), names_to = "ScoreCategory", values_to = "Value")
#Stacked bars by SAMPLE
histo_by_samples_cecum <- ggplot(histoca_cecum, aes(fill = ScoreCategory, y =Value , x = AnimalID)) +
geom_bar(stat = "identity")  +
ggtitle("Histopathology scores by sample (Cecum)") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
histo <- complete_sample_table
#subset by location
histo_cecum <- histo[histo$SampleLocation == 'C',]
#subset treatments with med-low ca
histoca_cecum<- histo_cecum[histo_cecum$TreatmentNumber  %in% c("3","4"),]
t.test(Value ~ Treatment, data = histo_ileum3)
t.test(Value ~ TreatmentNumber, data = histoca_cecum)
histoca_cecum <- histoca_cecum %>%
pivot_longer(cols = c("OverallArchitecture", "MucosalIntegrity", "LymphoidImmune", "InflammationSeverity", "MicrobialOrganisms"), names_to = "ScoreCategory", values_to = "Value")
t.test(Value ~ TreatmentNumber, data = histoca_cecum)
#Stacked bars by SAMPLE
histo_by_samples_cecum <- ggplot(histoca_cecum, aes(fill = ScoreCategory, y =Value , x = AnimalID)) +
geom_bar(stat = "identity")  +
ggtitle("Histopathology scores by sample (Cecum)") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
histo_by_samples_cecum
#ANOVA STATS
#cecum AdditiveScore
res.aov <- aov(AdditiveScore ~ Alphad3_level, data = histoca_cecum)
summary(res.aov) #Additive score changes significantly with treatment in cecum. pval=0.00232*
tukey <- TukeyHSD(res.aov)
print(tukey)
#letters to add statistics to graph
cld <- multcompLetters4(res.aov, tukey)
View(cld)
cld2 <- data.frame(letters = cld$'Alphad3_level'$Letters) #table with letters per treatment
cld2$Alphad3_level <- rownames(cld2)
names(cld2)[1] <- "histosig"
View(cld2)
#Satcked bars by TREATMENT
#cecum
histo_c <- split(histoca_cecum, histoca_cecum$Alphad3_level)
dff <- lapply(histo_c, function(x) ddply(x, .(ScoreCategory),
summarize, mean=mean(Value)))
listDF <- list()
for (i in 1:length(dff)){
#print(i)
dff[[i]]$Treatment <- names(dff)[i]
listDF[[i]] <- dff[[i]]
}
#Satcked bars by TREATMENT
#cecum
histo_c <- split(histoca_cecum, histoca_cecum$Alphad3_level)
dff <- lapply(histo_c, function(x) ddply(x, .(ScoreCategory),
summarize, mean=mean(Value)))
listDF <- list()
for (i in 1:length(dff)){
#print(i)
dff[[i]]$Alphad3_level <- names(dff)[i]
listDF[[i]] <- dff[[i]]
}
dfff <- do.call(rbind, listDF)
View(dfff)
treatments_cecum <- ggplot(dfff, aes(fill = ScoreCategory, y =mean , x =Treatment)) +
ylab("Mean additive Score") + xlab("") +
geom_bar(stat = "identity")  +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
theme(text=element_text(size=15))
treatments_cecum
treatments_cecum <- ggplot(dfff, aes(fill = ScoreCategory, y =mean , x =Alphad3_level)) +
ylab("Mean additive Score") + xlab("") +
geom_bar(stat = "identity")  +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
theme(text=element_text(size=15))
treatments_cecum
View(cld2)
#Add significancy letters manually
histo_cec_plot <- treatments_cecum+ annotate("text", x = 1, y = 12, label = cld2$histosig[1]) +
annotate("text", x = 2, y = 12, label = cld2$histosig[2])
histo_cec_plot
ggplotly(histo_cec_plot)
#ggplotly(histo_cec_plot)
histo_cec_plot
ggplotly(histo_cec_plot)
ggplotly(histo_cec_plot)
ggplotly(histo_cec_plot)
ggplotly(histo_cec_plot)
