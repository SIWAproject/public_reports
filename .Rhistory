otu_table=otu_table(ODLEPobj)
colnames(tax_table(ODLEPobj))
ntaxa(ODLEPobj)
metadata= meta(ODLEPobj)
colnames(metadata)
#Filter phyloseq object by location
ODLEPobj_cecum<-subset_samples(ODLEPobj, SampleLocation=="C")
ODLEPobj_ileum<-subset_samples(ODLEPobj, SampleLocation=="I")
ODLEPobj_feces<-subset_samples(ODLEPobj, SampleLocation=="F")
##Alpha diversity in 321 and 326 according to coccidia challenge
#Open saved object
ODLEPobj <- readRDS("/Users/mcadavid/Documents/Reports_review/E321_Maria/Microbiome_data/organized_R_data/phyloseqObject.rds")
#Filter phyloseq object to keeo only samples for age 21 in this case
ODLEPobj<-subset_samples(ODLEPobj, Age=="21")
##Keep only treatments that i want
metadata <- meta(ODLEPobj)
View(metadata)
ODLEPobj <- subset_samples(ODLEPobj, TreatmentNumber%in%c("4","10"))
#Filter phyloseq object by location
ODLEPobj_cecum<-subset_samples(ODLEPobj, SampleLocation=="C")
ODLEPobj_ileum<-subset_samples(ODLEPobj, SampleLocation=="I")
#Cecum
pc <-plot_anova_diversity_edit(ODLEPobj_cecum, method = c("richness", "shannon"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Cecum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
#ileum
pi <- plot_anova_diversity_edit(ODLEPobj_ileum, method = c("richness", "shannon"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Ileum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
pc
pi
pc +   scale_color_manual(values = c("Control" = "#00263A", "Product" = "#d6cb58"))
pc
pc + scale_color_manual(values = c("Chlldd+Untrtd" = "#00263A", "Product" = "#d6cb58"))
pi
pc
pc + scale_color_manual(values = c("Chlldd+Untrtd" = "#00263A", "Product" = "#d6cb58"))
pc + scale_color_manual(values = c("Chllgd+Untrtd" = "#00263A", "Product" = "#d6cb58"))
pc + scale_color_manual(values = c("Chllgd+Untrtd" = "#00263A", "Unchllgd+Untrt" = "#d6cb58"))
#Cecum
pc <-plot_anova_diversity_edit(ODLEPobj_cecum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Cecum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12)) +
#ileum
pi <- plot_anova_diversity_edit(ODLEPobj_ileum, method = c("richness", "shannon"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Ileum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
#Cecum
pc <-plot_anova_diversity_edit(ODLEPobj_cecum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Cecum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12)) +
#ileum
pi <- plot_anova_diversity_edit(ODLEPobj_ileum, method = c("richness", "shannon"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Ileum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
#Cecum
pc <-plot_anova_diversity_edit(ODLEPobj_cecum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Cecum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12)) +
#ileum
pi <- plot_anova_diversity_edit(ODLEPobj_ileum, method = c("richness", "shannon"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Ileum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
#Cecum
pc <-plot_anova_diversity_edit(ODLEPobj_cecum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Cecum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
#ileum
pi <- plot_anova_diversity_edit(ODLEPobj_ileum, method = c("richness", "shannon"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Ileum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
pc + scale_color_manual(values = c("Chllgd+Untrtd" = "#00263A", "Unchllgd+Untrt" = "#d6cb58"))
#ileum
pi <- plot_anova_diversity_edit(ODLEPobj_ileum, method = c("richness", "shannon"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Ileum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
pi + scale_color_manual(values = c("Chllgd+Untrtd" = "#00263A", "Unchllgd+Untrt" = "#d6cb58"))
#Cecum
pc <-plot_anova_diversity_edit(ODLEPobj_cecum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Cecum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
#ileum
pi <- plot_anova_diversity_edit(ODLEPobj_ileum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Ileum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
pc + scale_color_manual(values = c("Chllgd+Untrtd" = "#00263A", "Unchllgd+Untrt" = "#d6cb58"))
pi + scale_color_manual(values = c("Chllgd+Untrtd" = "#00263A", "Unchllgd+Untrt" = "#d6cb58"))
pc + scale_color_manual(values = c("Chllgd+Untrtd" = "#00263A", "Unchllgd+Untrt" = "#d6cb58"))
pi + scale_color_manual(values = c("Chllgd+Untrtd" = "#00263A", "Unchllgd+Untrt" = "#d6cb58"))
##EXPERIMENT 326
ODLEPobj <- readRDS("/Users/mcadavid/Documents/Reports_review/E326_Maria/E326phyloseqObject.rds")
metadata <- meta(ODLEPobj)
View(metadata)
##EXPERIMENT 326
ODLEPobj <- readRDS("/Users/mcadavid/Documents/Reports_review/E326_Maria/E326phyloseqObject.rds")
metadata <- meta(ODLEPobj)
##EXPERIMENT 326
ODLEPobj <- readRDS("/Users/mcadavid/Documents/Reports_review/E326_Maria/E326phyloseqObject.rds")
metadata <- meta(ODLEPobj)
View(metadata)
ODLEPobj <- subset_samples(ODLEPobj, TreatmentNumber%in%c("4","10"))
metadata <- meta(ODLEPobj)
View(metadata)
View(metadata)
##EXPERIMENT 326
ODLEPobj <- readRDS("/Users/mcadavid/Documents/Reports_review/E326_Maria/E326phyloseqObject.rds")
metadata <- meta(ODLEPobj)
View(metadata)
ODLEPobj <- subset_samples(ODLEPobj, TreatmentNumber%in%c("1","2"))
metadata <- meta(ODLEPobj)
View(metadata)
#Filter phyloseq object by location
ODLEPobj_cecum<-subset_samples(ODLEPobj, SampleLocation=="C")
ODLEPobj_ileum<-subset_samples(ODLEPobj, SampleLocation=="I")
#Cecum
pc <-plot_anova_diversity_edit(ODLEPobj_cecum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Cecum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
#Functions
source("/Volumes/GoogleDrive/Mi unidad/SIWAproject/Methods-review/functions_ME.R")
#Functions
source("/Volumes/GoogleDrive/Mi unidad/SIWAproject/Methods-review/functions.R")
#Cecum
pc <-plot_anova_diversity_edit(ODLEPobj_cecum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Cecum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
#ileum
pi <- plot_anova_diversity_edit(ODLEPobj_ileum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Ileum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
pc + scale_color_manual(values = c("Chllgd+Untrtd" = "#00263A", "Unchllgd+Untrt" = "#d6cb58"))
pi + scale_color_manual(values = c("Chllgd+Untrtd" = "#00263A", "Unchllgd+Untrt" = "#d6cb58"))
#Cecum
pc <-plot_anova_diversity_edit(ODLEPobj_cecum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Cecum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
pc + scale_color_manual(values = c("Chllgd+Untrtd" = "#00263A", "Unchllgd+Untrt" = "#d6cb58"))
#Cecum
pc <-plot_anova_diversity_edit(ODLEPobj_cecum, method = c("richness"),
grouping_column ="Treatment")+ xlab(NULL)+ylab("Cecum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
pc + scale_color_manual(values = c("Chllgd+Untrtd" = "#00263A", "Unchllgd+Untrt" = "#d6cb58"))
#Cecum
pc <-plot_anova_diversity_edit(ODLEPobj_cecum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Cecum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
#ileum
pi <- plot_anova_diversity_edit(ODLEPobj_ileum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Ileum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
pc + scale_color_manual(values = c("Chllgd+Untrtd" = "#84a7b9ff", "Unchllgd+Untrt" = "#f2eca5ff"))
pi + scale_color_manual(values = c("Chllgd+Untrtd" = "#84a7b9ff", "Unchllgd+Untrt" = "#f2eca5ff"))
pc + scale_color_manual(values = c("Chllgd+Untrtd" = "#84a7b9ff", "Unchllgd+Untrt" = "#a99b00ff"))
pi + scale_color_manual(values = c("Chllgd+Untrtd" = "#84a7b9ff", "Unchllgd+Untrt" = "#a99b00ff"))
##EXPERIMENT 321
#Open saved object
ODLEPobj <- readRDS("/Users/mcadavid/Documents/Reports_review/E321_Maria/Microbiome_data/organized_R_data/phyloseqObject.rds")
#Filter phyloseq object to keeo only samples for age 21 in this case
ODLEPobj<-subset_samples(ODLEPobj, Age=="21")
##Keep only treatments that i want
metadata <- meta(ODLEPobj)
ODLEPobj <- subset_samples(ODLEPobj, TreatmentNumber%in%c("4","10"))
#Filter phyloseq object by location
ODLEPobj_cecum<-subset_samples(ODLEPobj, SampleLocation=="C")
ODLEPobj_ileum<-subset_samples(ODLEPobj, SampleLocation=="I")
#Cecum
pc <-plot_anova_diversity_edit(ODLEPobj_cecum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Cecum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
#ileum
pi <- plot_anova_diversity_edit(ODLEPobj_ileum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Ileum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
pc + scale_color_manual(values = c("Chllgd+Untrtd" = "#00263A", "Unchllgd+Untrt" = "#d6cb58"))
#ileum
pi <- plot_anova_diversity_edit(ODLEPobj_ileum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Ileum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
pi + scale_color_manual(values = c("Chllgd+Untrtd" = "#00263A", "Unchllgd+Untrt" = "#d6cb58"))
##EXPERIMENT 326
ODLEPobj <- readRDS("/Users/mcadavid/Documents/Reports_review/E326_Maria/E326phyloseqObject.rds")
ODLEPobj <- subset_samples(ODLEPobj, TreatmentNumber%in%c("1","2"))
metadata <- meta(ODLEPobj)
#Filter phyloseq object by location
ODLEPobj_cecum<-subset_samples(ODLEPobj, SampleLocation=="C")
ODLEPobj_ileum<-subset_samples(ODLEPobj, SampleLocation=="I")
#Cecum
pc <-plot_anova_diversity_edit(ODLEPobj_cecum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Cecum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
#ileum
pi <- plot_anova_diversity_edit(ODLEPobj_ileum, method = c("richness"),
grouping_column ="Treatment",
pValueCutoff=0.05)+ xlab(NULL)+ylab("Ileum")+theme(legend.position = "none",
axis.title.y=element_text(angle = 0, vjust = .5, size = 12))
pc + scale_color_manual(values = c("Chllgd+Untrtd" = "#84a7b9ff", "Unchllgd+Untrt" = "#a99b00ff"))
pi + scale_color_manual(values = c("Chllgd+Untrtd" = "#84a7b9ff", "Unchllgd+Untrt" = "#a99b00ff"))
knitr::opts_chunk$set(echo = TRUE)
## FUNCTIONS
source("/Volumes/GoogleDrive/Mi unidad/SIWAproject/Methods-review(master)/functions.R")
View(plot_deseq_report_with_color_for_genera)
library(microViz)
plot_deseq_report_with_color_easyread_for_genera
folder  <- "/Volumes/GoogleDrive/Mi unidad/SIWAproject/Reports/Version1.0/Input_data/"
data <-
read.csv(
paste0(
folder,
"performance_histo_ge_ratios_alphadiv_for_correlations.csv"
),
check.names = FALSE,sep = '\t', header = TRUE
)
library(lsr)
quantileCut(data$FCR_corr_days22_33, 2)
#table(q)
data$splitFCR <- ntile(data$FCR_corr_days22_33, 2)
ODLEPobj <- readRDS("/Volumes/GoogleDrive/Mi unidad/SIWAproject/Reports/Version1.0/Input_data/phyloseqObject_April11.rds")
metadata <- as.data.frame(sample_data(ODLEPobj))
ODLEPobj <- ps_filter(ODLEPobj, SampleID %in% data$SampleID)
data$samples <- data$SampleID
data$FCRlevel <- ntile(data$FCR_corr_days22_33, 2)
ODLEPobj <- ps_join(x = ODLEPobj, y = data[,c("FCR_corr_days22_33", "samples", "FCRlevel")], match_sample_names = "samples")
wh0 = genefilter_sample(ODLEPobj, filterfun_sample(function(x) x >= 1), A=1)
ODLEPobj_filtered = prune_taxa(wh0, ODLEPobj)
agg_df <- aggregate_taxa_siwa(ODLEPobj_filtered, "Genus")
t <- as.data.frame(rownames(agg_df))
colnames(t) <- "Genus"
features <- agg_df
taxonomy <- t
rownames(taxonomy)<-taxonomy$Genus
featuresM <- as(features, "matrix")
class(featuresM) <- "numeric"
taxa_matrix<-as.matrix(taxonomy)
ASVobj = otu_table(featuresM, taxa_are_rows = TRUE)
TAXobj = tax_table(taxa_matrix)
SAMobj = sample_data(as.data.frame(sample_data(ODLEPobj)) )
ODLEPobjNEW = phyloseq(ASVobj, TAXobj, SAMobj)
PHYLO = ODLEPobjNEW
otu_table(PHYLO)[otu_table(PHYLO) == 0] <- 1
ddsOtu = phyloseq_to_deseq2(PHYLO, ~ SampleLocation + FCRlevel)
ddsOtu$group <- factor(paste0(ddsOtu$SampleLocation, ddsOtu$FCRlevel))
design(ddsOtu) <- ~ group
ddsOtu = DESeq(ddsOtu, sfType = "poscounts", test="Wald", fitType="parametric")
groupsST <- combn(x=levels(ddsOtu$group), m=2, simplify = FALSE)
same_location <- c()
for (i in 1:length(groupsST)){
if (gsub('[[:digit:]]+', '',  groupsST[[i]][[1]]) == gsub('[[:digit:]]+', '', groupsST[[i]][[2]])){
same_location[i] <- TRUE
} else {same_location[i]<- FALSE }
}
groupsST <- groupsST[same_location]
groupnamesST <- lapply(groupsST, function(x) {paste("DESeq ", x[1],"VS",x[2])})
resultsST <- lapply(groupsST, function(x) {results(ddsOtu, contrast=c("group",x[1],x[2]),cooksCutoff = FALSE)})
deseq2 <- list()
deseq2[["results"]] <- resultsST
deseq2[["groupscontrol"]] <- groupsST
deseq2[["groupnames"]] <- groupnamesST
resultsdeseq<- deseq2
list_dfs_filtered <- filter_deseq(resultsdeseq, PHYLO, alpha=0.05)
length(list_dfs_filtered$groups)
length(list_dfs_filtered$groups)
list_dfs_filtered <- filter_deseq(resultsdeseq, PHYLO, alpha=0.05)
install.packages("microViz",
repos = c(davidbarnett = "https://david-barnett.r-universe.dev", getOption("repos")),
lib ="/Users/mcadavid/Library/R/4.0/library")
install.packages("microViz", repos = c(davidbarnett = "https://david-barnett.r-universe.dev", getOption("repos")), lib = "/Users/mcadavid/Library/R/4.0/library")
library(microViz)
folder  <- "/Volumes/GoogleDrive/Mi unidad/SIWAproject/Reports/Version1.0/Input_data/"
data <-
read.csv(
paste0(
folder,
"performance_histo_ge_ratios_alphadiv_for_correlations.csv"
),
check.names = FALSE,sep = '\t', header = TRUE
)
library(microViz)
folder  <- "/Volumes/GoogleDrive/Mi unidad/SIWAproject/Reports/Version1.0/Input_data/"
data <-
read.csv(
paste0(
folder,
"performance_histo_ge_ratios_alphadiv_for_correlations.csv"
),
check.names = FALSE,sep = '\t', header = TRUE
)
library(lsr)
quantileCut(data$FCR_corr_days22_33, 2)
#table(q)
data$splitFCR <- ntile(data$FCR_corr_days22_33, 2)
ODLEPobj <- readRDS("/Volumes/GoogleDrive/Mi unidad/SIWAproject/Reports/Version1.0/Input_data/phyloseqObject_April11.rds")
metadata <- as.data.frame(sample_data(ODLEPobj))
ODLEPobj <- ps_filter(ODLEPobj, SampleID %in% data$SampleID)
data$samples <- data$SampleID
data$FCRlevel <- ntile(data$FCR_corr_days22_33, 2)
ODLEPobj <- ps_join(x = ODLEPobj, y = data[,c("FCR_corr_days22_33", "samples", "FCRlevel")], match_sample_names = "samples")
wh0 = genefilter_sample(ODLEPobj, filterfun_sample(function(x) x >= 1), A=1)
ODLEPobj_filtered = prune_taxa(wh0, ODLEPobj)
agg_df <- aggregate_taxa_siwa(ODLEPobj_filtered, "Genus")
t <- as.data.frame(rownames(agg_df))
colnames(t) <- "Genus"
features <- agg_df
taxonomy <- t
rownames(taxonomy)<-taxonomy$Genus
featuresM <- as(features, "matrix")
class(featuresM) <- "numeric"
taxa_matrix<-as.matrix(taxonomy)
ASVobj = otu_table(featuresM, taxa_are_rows = TRUE)
TAXobj = tax_table(taxa_matrix)
SAMobj = sample_data(as.data.frame(sample_data(ODLEPobj)) )
ODLEPobjNEW = phyloseq(ASVobj, TAXobj, SAMobj)
PHYLO = ODLEPobjNEW
otu_table(PHYLO)[otu_table(PHYLO) == 0] <- 1
ddsOtu = phyloseq_to_deseq2(PHYLO, ~ SampleLocation + FCRlevel)
ddsOtu$group <- factor(paste0(ddsOtu$SampleLocation, ddsOtu$FCRlevel))
design(ddsOtu) <- ~ group
ddsOtu = DESeq(ddsOtu, sfType = "poscounts", test="Wald", fitType="parametric")
###load libraries panels tabs####
library(phyloseq) #
library(DESeq2) #
library(kableExtra) #
library(genefilter) #
library(microbiome) #
library(ggplot2)  #
library(vegan) #
library(ggpubr) #
library(ggplot2) #
library(plyr)
library(multcompView)
#####Load libraries correlations####
library(ggplot2)
library(phyloseq)
library(stringr)
library(dplyr)
#####Load libraries LR####
library(tidyverse)
library(ape)
library(ggpubr)
####Load libraries categorical histo####
library(kableExtra)
library(plyr)
library("fantaxtic")
library(data.table)
####load libraries Ratios-histo boxplots####
library(multcompView)
library(reshape)
### OTRICAS
library(plotly)
library(plyr)
library(flexdashboard)
library(shiny)
library(DT)
library(stringr)
library(rstatix)
library(microViz)
library(lsr)
## FUNCTIONS
source("/Volumes/GoogleDrive/Mi unidad/SIWAproject/Methods-review(master)/functions.R")
otu_table(PHYLO)[otu_table(PHYLO) == 0] <- 1
ddsOtu = phyloseq_to_deseq2(PHYLO, ~ SampleLocation + FCRlevel)
ddsOtu$group <- factor(paste0(ddsOtu$SampleLocation, ddsOtu$FCRlevel))
design(ddsOtu) <- ~ group
ddsOtu = DESeq(ddsOtu, sfType = "poscounts", test="Wald", fitType="parametric")
groupsST <- combn(x=levels(ddsOtu$group), m=2, simplify = FALSE)
same_location <- c()
for (i in 1:length(groupsST)){
if (gsub('[[:digit:]]+', '',  groupsST[[i]][[1]]) == gsub('[[:digit:]]+', '', groupsST[[i]][[2]])){
same_location[i] <- TRUE
} else {same_location[i]<- FALSE }
}
groupsST <- groupsST[same_location]
groupnamesST <- lapply(groupsST, function(x) {paste("DESeq ", x[1],"VS",x[2])})
resultsST <- lapply(groupsST, function(x) {results(ddsOtu, contrast=c("group",x[1],x[2]),cooksCutoff = FALSE)})
deseq2 <- list()
deseq2[["results"]] <- resultsST
deseq2[["groupscontrol"]] <- groupsST
deseq2[["groupnames"]] <- groupnamesST
resultsdeseq<- deseq2
list_dfs_filtered <- filter_deseq(resultsdeseq, PHYLO, alpha=0.05)
length(list_dfs_filtered$groups)
saveRDS(list_dfs_filtered, file = "/Volumes/GoogleDrive/Mi unidad/SIWAproject/Reports/Projects/E335_MS/diff_abund/list_dfs_filtered_bygenus_perf.RData")
list_dfs_filtered <- readRDS("/Volumes/GoogleDrive/Mi unidad/SIWAproject/Reports/Projects/E335_MS/diff_abund/list_dfs_filtered_bygenus_perf.RData")
plot_deseq_report_with_color_easyread_for_genera(list_dfs_filtered, 1,
"Cecum: Low vs. High FCR",
species_taxonomy_info,
genera_taxonomy_info,  size=8)
###load libraries panels tabs####
library(phyloseq) #
library(DESeq2) #
library(kableExtra) #
library(genefilter) #
library(microbiome) #
library(ggplot2)  #
library(vegan) #
library(ggpubr) #
library(ggplot2) #
library(plyr)
library(multcompView)
#####Load libraries correlations####
library(ggplot2)
library(phyloseq)
library(stringr)
library(dplyr)
#####Load libraries LR####
library(tidyverse)
library(ape)
library(ggpubr)
####Load libraries categorical histo####
library(kableExtra)
library(plyr)
library("fantaxtic")
library(data.table)
####load libraries Ratios-histo boxplots####
library(multcompView)
library(reshape)
### OTRICAS
library(plotly)
library(plyr)
library(flexdashboard)
library(shiny)
library(DT)
library(stringr)
library(rstatix)
library(microViz)
library(lsr)
## FUNCTIONS
source("/Volumes/GoogleDrive/Mi unidad/SIWAproject/Methods-review(master)/functions.R")
###load libraries panels tabs####
library(phyloseq) #
library(DESeq2) #
library(kableExtra) #
library(genefilter) #
library(microbiome) #
library(ggplot2)  #
library(vegan) #
library(ggpubr) #
library(ggplot2) #
library(plyr)
library(multcompView)
#####Load libraries correlations####
library(ggplot2)
library(phyloseq)
library(stringr)
library(dplyr)
#####Load libraries LR####
library(tidyverse)
library(ape)
library(ggpubr)
####Load libraries categorical histo####
library(kableExtra)
library(plyr)
library("fantaxtic")
library(data.table)
####load libraries Ratios-histo boxplots####
library(multcompView)
library(reshape)
### OTRICAS
library(plotly)
library(plyr)
library(flexdashboard)
library(shiny)
library(DT)
library(stringr)
library(rstatix)
library(microViz)
library(lsr)
## FUNCTIONS
source("/Volumes/GoogleDrive/Mi unidad/SIWAproject/Methods-review(master)/functions.R")
#open phyloseq object
folder <- "/Volumes/GoogleDrive/Mi unidad/SIWAproject/Reports/Version1.0/Input_data/"
ODLEPobj <- readRDS(paste0(folder, "phyloseqObject_April11.rds"))
#open data-table
## Data creada con create_full_file_for_correlations_to_analytics - Jupyter Notebook
complete_sample_table <-read.table(paste0(folder, "performance_histo_ge_ratios_alphadiv_for_correlations.csv"),check.names = FALSE, header=T, sep="\t")
#EAFIT surveillance tables (same for all reports)
species_taxonomy_info <-read.csv(paste0(folder, "species_metabolic_effects.csv"),check.names = FALSE, sep=";")
genera_taxonomy_info <- read.csv(paste0(folder, "genus_metabolic_effects.csv"), check.names = FALSE, sep=";")
broad_taxonomy_info <- read.csv(paste0(folder, "broad_groups_metabolic_effects.csv"), check.names = FALSE, sep=";")
#Deseq outputs
dfs_filtered <- readRDS(file="/Volumes/GoogleDrive/Mi unidad/SIWAproject/Reports/Version1.0/Input_data/dfs_filtered.RData")
list_dfs_filtered <- readRDS("/Volumes/GoogleDrive/Mi unidad/SIWAproject/Reports/Projects/E335_MS/diff_abund/list_dfs_filtered_bygenus_perf.RData")
plot_deseq_report_with_color_easyread_for_genera(list_dfs_filtered, 1,
"Cecum: Low vs. High FCR",
species_taxonomy_info,
genera_taxonomy_info,  size=8)
plot_deseq_report_with_color_easyread_for_genera(list_dfs_filtered, 2,
"Ileum: Low vs. High FCR",
species_taxonomy_info,
genera_taxonomy_info,  size=8)
